Module(body=[Import(names=[alias(name='json')]), Import(names=[alias(name='os')]), Import(names=[alias(name='yaml')]), ImportFrom(module='datetime', names=[alias(name='datetime')], level=0), ImportFrom(module='dotenv', names=[alias(name='load_dotenv')], level=0), Expr(value=Call(func=Name(id='load_dotenv', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='USE_GPTPILOT_FOLDER', ctx=Store())], value=Compare(left=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='getenv', ctx=Load()), args=[Constant(value='USE_GPTPILOT_FOLDER')], keywords=[]), ops=[Eq()], comparators=[Constant(value='true')])), ClassDef(name='DotGptPilot', bases=[], keywords=[], body=[Expr(value=Constant(value='\n    Manages the `.gpt-pilot` directory.\n    ')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='log_chat_completions', annotation=Name(id='bool', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=True)]), body=[If(test=UnaryOp(op=Not(), operand=Name(id='USE_GPTPILOT_FOLDER', ctx=Load())), body=[Return()], orelse=[]), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='log_chat_completions', ctx=Store())], value=Name(id='log_chat_completions', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='dot_gpt_pilot_path', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='with_root_path', ctx=Load()), args=[Constant(value='~')], keywords=[keyword(arg='create', value=Constant(value=False))])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='chat_log_path', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='chat_log_folder', ctx=Load()), args=[Constant(value=None)], keywords=[]))], decorator_list=[]), FunctionDef(name='with_root_path', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='root_path', annotation=Name(id='str', ctx=Load())), arg(arg='create')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=True)]), body=[If(test=UnaryOp(op=Not(), operand=Name(id='USE_GPTPILOT_FOLDER', ctx=Load())), body=[Return()], orelse=[]), Assign(targets=[Name(id='dot_gpt_pilot_path', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='expanduser', ctx=Load()), args=[Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='join', ctx=Load()), args=[Name(id='root_path', ctx=Load()), Constant(value='.gpt-pilot')], keywords=[])], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='dot_gpt_pilot_path', ctx=Store())], value=Name(id='dot_gpt_pilot_path', ctx=Load())), If(test=BoolOp(op=And(), values=[Name(id='create', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='log_chat_completions', ctx=Load())]), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='chat_log_folder', ctx=Load()), args=[Constant(value=None)], keywords=[]))], orelse=[]), Return(value=Name(id='dot_gpt_pilot_path', ctx=Load()))], decorator_list=[]), FunctionDef(name='chat_log_folder', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='task')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Name(id='USE_GPTPILOT_FOLDER', ctx=Load())), body=[Return()], orelse=[]), Assign(targets=[Name(id='chat_log_path', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='join', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='dot_gpt_pilot_path', ctx=Load()), Constant(value='chat_log')], keywords=[])), If(test=Compare(left=Name(id='task', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), body=[Assign(targets=[Name(id='chat_log_path', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='join', ctx=Load()), args=[Name(id='chat_log_path', ctx=Load()), BinOp(left=Constant(value='task_'), op=Add(), right=Call(func=Name(id='str', ctx=Load()), args=[Name(id='task', ctx=Load())], keywords=[]))], keywords=[]))], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='makedirs', ctx=Load()), args=[Name(id='chat_log_path', ctx=Load())], keywords=[keyword(arg='exist_ok', value=Constant(value=True))])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='chat_log_path', ctx=Store())], value=Name(id='chat_log_path', ctx=Load())), Return(value=Name(id='chat_log_path', ctx=Load()))], decorator_list=[]), FunctionDef(name='log_chat_completion', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='endpoint', annotation=Name(id='str', ctx=Load())), arg(arg='model', annotation=Name(id='str', ctx=Load())), arg(arg='req_type', annotation=Name(id='str', ctx=Load())), arg(arg='messages', annotation=Subscript(value=Name(id='list', ctx=Load()), slice=Name(id='dict', ctx=Load()), ctx=Load())), arg(arg='response', annotation=Name(id='str', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Name(id='USE_GPTPILOT_FOLDER', ctx=Load())), body=[Return()], orelse=[]), If(test=Attribute(value=Name(id='self', ctx=Load()), attr='log_chat_completions', ctx=Load()), body=[Assign(targets=[Name(id='time', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='datetime', ctx=Load()), attr='now', ctx=Load()), args=[], keywords=[]), attr='strftime', ctx=Load()), args=[Constant(value='%Y-%m-%d_%H_%M_%S')], keywords=[])), With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='join', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='chat_log_path', ctx=Load()), JoinedStr(values=[FormattedValue(value=Name(id='time', ctx=Load()), conversion=-1), Constant(value='-'), FormattedValue(value=Name(id='req_type', ctx=Load()), conversion=-1), Constant(value='.yaml')])], keywords=[]), Constant(value='w')], keywords=[keyword(arg='encoding', value=Constant(value='utf-8'))]), optional_vars=Name(id='file', ctx=Store()))], body=[Assign(targets=[Name(id='data', ctx=Store())], value=Dict(keys=[Constant(value='endpoint'), Constant(value='model'), Constant(value='messages'), Constant(value='response')], values=[Name(id='endpoint', ctx=Load()), Name(id='model', ctx=Load()), Name(id='messages', ctx=Load()), Name(id='response', ctx=Load())])), Expr(value=Call(func=Attribute(value=Name(id='yaml', ctx=Load()), attr='safe_dump', ctx=Load()), args=[Name(id='data', ctx=Load()), Name(id='file', ctx=Load())], keywords=[keyword(arg='width', value=Constant(value=120)), keyword(arg='indent', value=Constant(value=2)), keyword(arg='default_flow_style', value=Constant(value=False)), keyword(arg='sort_keys', value=Constant(value=False))]))])], orelse=[])], decorator_list=[]), FunctionDef(name='log_chat_completion_json', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='endpoint', annotation=Name(id='str', ctx=Load())), arg(arg='model', annotation=Name(id='str', ctx=Load())), arg(arg='req_type', annotation=Name(id='str', ctx=Load())), arg(arg='functions', annotation=Name(id='dict', ctx=Load())), arg(arg='json_response', annotation=Name(id='str', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Name(id='USE_GPTPILOT_FOLDER', ctx=Load())), body=[Return()], orelse=[]), If(test=Attribute(value=Name(id='self', ctx=Load()), attr='log_chat_completions', ctx=Load()), body=[Assign(targets=[Name(id='time', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='datetime', ctx=Load()), attr='now', ctx=Load()), args=[], keywords=[]), attr='strftime', ctx=Load()), args=[Constant(value='%Y-%m-%d_%H_%M_%S')], keywords=[])), With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='join', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='chat_log_path', ctx=Load()), JoinedStr(values=[FormattedValue(value=Name(id='time', ctx=Load()), conversion=-1), Constant(value='-'), FormattedValue(value=Name(id='req_type', ctx=Load()), conversion=-1), Constant(value='.json')])], keywords=[]), Constant(value='w')], keywords=[keyword(arg='encoding', value=Constant(value='utf-8'))]), optional_vars=Name(id='file', ctx=Store()))], body=[Assign(targets=[Name(id='data', ctx=Store())], value=Dict(keys=[Constant(value='endpoint'), Constant(value='model'), Constant(value='functions'), Constant(value='response')], values=[Name(id='endpoint', ctx=Load()), Name(id='model', ctx=Load()), Name(id='functions', ctx=Load()), Call(func=Attribute(value=Name(id='json', ctx=Load()), attr='loads', ctx=Load()), args=[Name(id='json_response', ctx=Load())], keywords=[])])), Expr(value=Call(func=Attribute(value=Name(id='json', ctx=Load()), attr='dump', ctx=Load()), args=[Name(id='data', ctx=Load()), Name(id='file', ctx=Load())], keywords=[keyword(arg='indent', value=Constant(value=2))]))])], orelse=[])], decorator_list=[]), FunctionDef(name='write_project', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='project')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Name(id='USE_GPTPILOT_FOLDER', ctx=Load())), body=[Return()], orelse=[]), Assign(targets=[Name(id='data', ctx=Store())], value=Dict(keys=[Constant(value='name'), Constant(value='description'), Constant(value='user_stories'), Constant(value='architecture'), Constant(value='development_plan')], values=[Subscript(value=Attribute(value=Name(id='project', ctx=Load()), attr='args', ctx=Load()), slice=Constant(value='name'), ctx=Load()), Attribute(value=Name(id='project', ctx=Load()), attr='project_description', ctx=Load()), Attribute(value=Name(id='project', ctx=Load()), attr='user_stories', ctx=Load()), Attribute(value=Name(id='project', ctx=Load()), attr='architecture', ctx=Load()), Attribute(value=Name(id='project', ctx=Load()), attr='development_plan', ctx=Load())])), With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='join', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='dot_gpt_pilot_path', ctx=Load()), Constant(value='project.yaml')], keywords=[]), Constant(value='w')], keywords=[]), optional_vars=Name(id='file', ctx=Store()))], body=[Expr(value=Call(func=Attribute(value=Name(id='yaml', ctx=Load()), attr='safe_dump', ctx=Load()), args=[Name(id='data', ctx=Load()), Name(id='file', ctx=Load())], keywords=[keyword(arg='width', value=Constant(value=120)), keyword(arg='indent', value=Constant(value=2)), keyword(arg='default_flow_style', value=Constant(value=False)), keyword(arg='sort_keys', value=Constant(value=False))]))])], decorator_list=[])], decorator_list=[])], type_ignores=[])