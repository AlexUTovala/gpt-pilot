Module(body=[Import(names=[alias(name='os')]), Import(names=[alias(name='re')]), Import(names=[alias(name='logging')]), FunctionDef(name='setup_logger', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='log_format', ctx=Store())], value=Constant(value='%(asctime)s [%(filename)s:%(lineno)s - %(funcName)20s() ] %(levelname)s: %(message)s')), Assign(targets=[Name(id='file_handler', ctx=Store())], value=Call(func=Attribute(value=Name(id='logging', ctx=Load()), attr='FileHandler', ctx=Load()), args=[], keywords=[keyword(arg='filename', value=Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='join', ctx=Load()), args=[Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='dirname', ctx=Load()), args=[Name(id='__file__', ctx=Load())], keywords=[]), Constant(value='debug.log')], keywords=[])), keyword(arg='mode', value=Constant(value='w')), keyword(arg='encoding', value=Constant(value='utf-8'))])), Assign(targets=[Name(id='formatter', ctx=Store())], value=Call(func=Attribute(value=Name(id='logging', ctx=Load()), attr='Formatter', ctx=Load()), args=[Name(id='log_format', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='file_handler', ctx=Load()), attr='setFormatter', ctx=Load()), args=[Name(id='formatter', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='file_handler', ctx=Load()), attr='addFilter', ctx=Load()), args=[Name(id='filter_sensitive_fields', ctx=Load())], keywords=[])), Assign(targets=[Name(id='logger', ctx=Store())], value=Call(func=Attribute(value=Name(id='logging', ctx=Load()), attr='getLogger', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load()), attr='addHandler', ctx=Load()), args=[Name(id='file_handler', ctx=Load())], keywords=[])), If(test=Compare(left=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='getenv', ctx=Load()), args=[Constant(value='DEBUG')], keywords=[]), ops=[Eq()], comparators=[Constant(value='true')]), body=[Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load()), attr='setLevel', ctx=Load()), args=[Attribute(value=Name(id='logging', ctx=Load()), attr='DEBUG', ctx=Load())], keywords=[]))], orelse=[Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load()), attr='setLevel', ctx=Load()), args=[Attribute(value=Name(id='logging', ctx=Load()), attr='INFO', ctx=Load())], keywords=[]))]), Return(value=Name(id='logger', ctx=Load()))], decorator_list=[]), Assign(targets=[Name(id='sensitive_fields', ctx=Store())], value=List(elts=[Constant(value='--api-key'), Constant(value='password')], ctx=Load())), FunctionDef(name='filter_sensitive_fields', args=arguments(posonlyargs=[], args=[arg(arg='record')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Attribute(value=Name(id='record', ctx=Load()), attr='args', ctx=Load()), Name(id='dict', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='args', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='record', ctx=Load()), attr='args', ctx=Load()), attr='copy', ctx=Load()), args=[], keywords=[])), For(target=Name(id='field', ctx=Store()), iter=Name(id='sensitive_fields', ctx=Load()), body=[If(test=Compare(left=Name(id='field', ctx=Load()), ops=[In()], comparators=[Name(id='args', ctx=Load())]), body=[Assign(targets=[Subscript(value=Name(id='args', ctx=Load()), slice=Name(id='field', ctx=Load()), ctx=Store())], value=Constant(value='*****'))], orelse=[])], orelse=[]), Assign(targets=[Attribute(value=Name(id='record', ctx=Load()), attr='args', ctx=Store())], value=Name(id='args', ctx=Load()))], orelse=[If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Attribute(value=Name(id='record', ctx=Load()), attr='args', ctx=Load()), Name(id='tuple', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='args_list', ctx=Store())], value=Call(func=Name(id='list', ctx=Load()), args=[Attribute(value=Name(id='record', ctx=Load()), attr='args', ctx=Load())], keywords=[])), Assign(targets=[Name(id='args_list', ctx=Store())], value=ListComp(elt=IfExp(test=Compare(left=Name(id='arg', ctx=Load()), ops=[In()], comparators=[Name(id='sensitive_fields', ctx=Load())]), body=Constant(value='*****'), orelse=Name(id='arg', ctx=Load())), generators=[comprehension(target=Name(id='arg', ctx=Store()), iter=Name(id='args_list', ctx=Load()), ifs=[], is_async=0)])), Assign(targets=[Attribute(value=Name(id='record', ctx=Load()), attr='args', ctx=Store())], value=Call(func=Name(id='tuple', ctx=Load()), args=[Name(id='args_list', ctx=Load())], keywords=[]))], orelse=[])]), If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Attribute(value=Name(id='record', ctx=Load()), attr='msg', ctx=Load()), Name(id='str', ctx=Load())], keywords=[]), body=[Assign(targets=[Attribute(value=Name(id='record', ctx=Load()), attr='msg', ctx=Store())], value=Call(func=Attribute(value=Name(id='re', ctx=Load()), attr='sub', ctx=Load()), args=[Constant(value='\\x1B(?:[@-Z\\\\-_]|\\[[0-?]*[ -/]*[@-~])'), Constant(value=''), Attribute(value=Name(id='record', ctx=Load()), attr='msg', ctx=Load())], keywords=[]))], orelse=[]), Return(value=Constant(value=True))], decorator_list=[]), Assign(targets=[Name(id='logger', ctx=Store())], value=Call(func=Name(id='setup_logger', ctx=Load()), args=[], keywords=[]))], type_ignores=[])