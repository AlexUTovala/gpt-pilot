Module(body=[Assign(targets=[Name(id='__all__', ctx=Store())], value=List(elts=[Constant(value='Composer'), Constant(value='ComposerError')], ctx=Load())), ImportFrom(module='error', names=[alias(name='MarkedYAMLError')], level=1), ImportFrom(module='events', names=[alias(name='*')], level=1), ImportFrom(module='nodes', names=[alias(name='*')], level=1), ClassDef(name='ComposerError', bases=[Name(id='MarkedYAMLError', ctx=Load())], keywords=[], body=[Pass()], decorator_list=[]), ClassDef(name='Composer', bases=[], keywords=[], body=[FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Store())], value=Dict(keys=[], values=[]))], decorator_list=[]), FunctionDef(name='check_node', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='StreamStartEvent', ctx=Load())], keywords=[]), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[]))], orelse=[]), Return(value=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='StreamEndEvent', ctx=Load())], keywords=[])))], decorator_list=[]), FunctionDef(name='get_node', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='StreamEndEvent', ctx=Load())], keywords=[])), body=[Return(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='compose_document', ctx=Load()), args=[], keywords=[]))], orelse=[])], decorator_list=[]), FunctionDef(name='get_single_node', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='document', ctx=Store())], value=Constant(value=None)), If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='StreamEndEvent', ctx=Load())], keywords=[])), body=[Assign(targets=[Name(id='document', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='compose_document', ctx=Load()), args=[], keywords=[]))], orelse=[]), If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='StreamEndEvent', ctx=Load())], keywords=[])), body=[Assign(targets=[Name(id='event', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Raise(exc=Call(func=Name(id='ComposerError', ctx=Load()), args=[Constant(value='expected a single document in the stream'), Attribute(value=Name(id='document', ctx=Load()), attr='start_mark', ctx=Load()), Constant(value='but found another document'), Attribute(value=Name(id='event', ctx=Load()), attr='start_mark', ctx=Load())], keywords=[]))], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Return(value=Name(id='document', ctx=Load()))], decorator_list=[]), FunctionDef(name='compose_document', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='node', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='compose_node', ctx=Load()), args=[Constant(value=None), Constant(value=None)], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Store())], value=Dict(keys=[], values=[])), Return(value=Name(id='node', ctx=Load()))], decorator_list=[]), FunctionDef(name='compose_node', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='parent'), arg(arg='index')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='AliasEvent', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='event', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='anchor', ctx=Store())], value=Attribute(value=Name(id='event', ctx=Load()), attr='anchor', ctx=Load())), If(test=Compare(left=Name(id='anchor', ctx=Load()), ops=[NotIn()], comparators=[Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load())]), body=[Raise(exc=Call(func=Name(id='ComposerError', ctx=Load()), args=[Constant(value=None), Constant(value=None), BinOp(left=Constant(value='found undefined alias %r'), op=Mod(), right=Name(id='anchor', ctx=Load())), Attribute(value=Name(id='event', ctx=Load()), attr='start_mark', ctx=Load())], keywords=[]))], orelse=[]), Return(value=Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load()), slice=Name(id='anchor', ctx=Load()), ctx=Load()))], orelse=[]), Assign(targets=[Name(id='event', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='peek_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='anchor', ctx=Store())], value=Attribute(value=Name(id='event', ctx=Load()), attr='anchor', ctx=Load())), If(test=Compare(left=Name(id='anchor', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), body=[If(test=Compare(left=Name(id='anchor', ctx=Load()), ops=[In()], comparators=[Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load())]), body=[Raise(exc=Call(func=Name(id='ComposerError', ctx=Load()), args=[BinOp(left=Constant(value='found duplicate anchor %r; first occurrence'), op=Mod(), right=Name(id='anchor', ctx=Load())), Attribute(value=Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load()), slice=Name(id='anchor', ctx=Load()), ctx=Load()), attr='start_mark', ctx=Load()), Constant(value='second occurrence'), Attribute(value=Name(id='event', ctx=Load()), attr='start_mark', ctx=Load())], keywords=[]))], orelse=[])], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='descend_resolver', ctx=Load()), args=[Name(id='parent', ctx=Load()), Name(id='index', ctx=Load())], keywords=[])), If(test=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='ScalarEvent', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='node', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='compose_scalar_node', ctx=Load()), args=[Name(id='anchor', ctx=Load())], keywords=[]))], orelse=[If(test=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='SequenceStartEvent', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='node', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='compose_sequence_node', ctx=Load()), args=[Name(id='anchor', ctx=Load())], keywords=[]))], orelse=[If(test=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='MappingStartEvent', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='node', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='compose_mapping_node', ctx=Load()), args=[Name(id='anchor', ctx=Load())], keywords=[]))], orelse=[])])]), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='ascend_resolver', ctx=Load()), args=[], keywords=[])), Return(value=Name(id='node', ctx=Load()))], decorator_list=[]), FunctionDef(name='compose_scalar_node', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='anchor')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='event', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='tag', ctx=Store())], value=Attribute(value=Name(id='event', ctx=Load()), attr='tag', ctx=Load())), If(test=BoolOp(op=Or(), values=[Compare(left=Name(id='tag', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), Compare(left=Name(id='tag', ctx=Load()), ops=[Eq()], comparators=[Constant(value='!')])]), body=[Assign(targets=[Name(id='tag', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='resolve', ctx=Load()), args=[Name(id='ScalarNode', ctx=Load()), Attribute(value=Name(id='event', ctx=Load()), attr='value', ctx=Load()), Attribute(value=Name(id='event', ctx=Load()), attr='implicit', ctx=Load())], keywords=[]))], orelse=[]), Assign(targets=[Name(id='node', ctx=Store())], value=Call(func=Name(id='ScalarNode', ctx=Load()), args=[Name(id='tag', ctx=Load()), Attribute(value=Name(id='event', ctx=Load()), attr='value', ctx=Load()), Attribute(value=Name(id='event', ctx=Load()), attr='start_mark', ctx=Load()), Attribute(value=Name(id='event', ctx=Load()), attr='end_mark', ctx=Load())], keywords=[keyword(arg='style', value=Attribute(value=Name(id='event', ctx=Load()), attr='style', ctx=Load()))])), If(test=Compare(left=Name(id='anchor', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), body=[Assign(targets=[Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load()), slice=Name(id='anchor', ctx=Load()), ctx=Store())], value=Name(id='node', ctx=Load()))], orelse=[]), Return(value=Name(id='node', ctx=Load()))], decorator_list=[]), FunctionDef(name='compose_sequence_node', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='anchor')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='start_event', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='tag', ctx=Store())], value=Attribute(value=Name(id='start_event', ctx=Load()), attr='tag', ctx=Load())), If(test=BoolOp(op=Or(), values=[Compare(left=Name(id='tag', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), Compare(left=Name(id='tag', ctx=Load()), ops=[Eq()], comparators=[Constant(value='!')])]), body=[Assign(targets=[Name(id='tag', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='resolve', ctx=Load()), args=[Name(id='SequenceNode', ctx=Load()), Constant(value=None), Attribute(value=Name(id='start_event', ctx=Load()), attr='implicit', ctx=Load())], keywords=[]))], orelse=[]), Assign(targets=[Name(id='node', ctx=Store())], value=Call(func=Name(id='SequenceNode', ctx=Load()), args=[Name(id='tag', ctx=Load()), List(elts=[], ctx=Load()), Attribute(value=Name(id='start_event', ctx=Load()), attr='start_mark', ctx=Load()), Constant(value=None)], keywords=[keyword(arg='flow_style', value=Attribute(value=Name(id='start_event', ctx=Load()), attr='flow_style', ctx=Load()))])), If(test=Compare(left=Name(id='anchor', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), body=[Assign(targets=[Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load()), slice=Name(id='anchor', ctx=Load()), ctx=Store())], value=Name(id='node', ctx=Load()))], orelse=[]), Assign(targets=[Name(id='index', ctx=Store())], value=Constant(value=0)), While(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='SequenceEndEvent', ctx=Load())], keywords=[])), body=[Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), attr='append', ctx=Load()), args=[Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='compose_node', ctx=Load()), args=[Name(id='node', ctx=Load()), Name(id='index', ctx=Load())], keywords=[])], keywords=[])), AugAssign(target=Name(id='index', ctx=Store()), op=Add(), value=Constant(value=1))], orelse=[]), Assign(targets=[Name(id='end_event', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Attribute(value=Name(id='node', ctx=Load()), attr='end_mark', ctx=Store())], value=Attribute(value=Name(id='end_event', ctx=Load()), attr='end_mark', ctx=Load())), Return(value=Name(id='node', ctx=Load()))], decorator_list=[]), FunctionDef(name='compose_mapping_node', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='anchor')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='start_event', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='tag', ctx=Store())], value=Attribute(value=Name(id='start_event', ctx=Load()), attr='tag', ctx=Load())), If(test=BoolOp(op=Or(), values=[Compare(left=Name(id='tag', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), Compare(left=Name(id='tag', ctx=Load()), ops=[Eq()], comparators=[Constant(value='!')])]), body=[Assign(targets=[Name(id='tag', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='resolve', ctx=Load()), args=[Name(id='MappingNode', ctx=Load()), Constant(value=None), Attribute(value=Name(id='start_event', ctx=Load()), attr='implicit', ctx=Load())], keywords=[]))], orelse=[]), Assign(targets=[Name(id='node', ctx=Store())], value=Call(func=Name(id='MappingNode', ctx=Load()), args=[Name(id='tag', ctx=Load()), List(elts=[], ctx=Load()), Attribute(value=Name(id='start_event', ctx=Load()), attr='start_mark', ctx=Load()), Constant(value=None)], keywords=[keyword(arg='flow_style', value=Attribute(value=Name(id='start_event', ctx=Load()), attr='flow_style', ctx=Load()))])), If(test=Compare(left=Name(id='anchor', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), body=[Assign(targets=[Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load()), slice=Name(id='anchor', ctx=Load()), ctx=Store())], value=Name(id='node', ctx=Load()))], orelse=[]), While(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='check_event', ctx=Load()), args=[Name(id='MappingEndEvent', ctx=Load())], keywords=[])), body=[Assign(targets=[Name(id='item_key', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='compose_node', ctx=Load()), args=[Name(id='node', ctx=Load()), Constant(value=None)], keywords=[])), Assign(targets=[Name(id='item_value', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='compose_node', ctx=Load()), args=[Name(id='node', ctx=Load()), Name(id='item_key', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Name(id='item_key', ctx=Load()), Name(id='item_value', ctx=Load())], ctx=Load())], keywords=[]))], orelse=[]), Assign(targets=[Name(id='end_event', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='get_event', ctx=Load()), args=[], keywords=[])), Assign(targets=[Attribute(value=Name(id='node', ctx=Load()), attr='end_mark', ctx=Store())], value=Attribute(value=Name(id='end_event', ctx=Load()), attr='end_mark', ctx=Load())), Return(value=Name(id='node', ctx=Load()))], decorator_list=[])], decorator_list=[])], type_ignores=[])