Module(body=[Assign(targets=[Name(id='__all__', ctx=Store())], value=List(elts=[Constant(value='Serializer'), Constant(value='SerializerError')], ctx=Load())), ImportFrom(module='error', names=[alias(name='YAMLError')], level=1), ImportFrom(module='events', names=[alias(name='*')], level=1), ImportFrom(module='nodes', names=[alias(name='*')], level=1), ClassDef(name='SerializerError', bases=[Name(id='YAMLError', ctx=Load())], keywords=[], body=[Pass()], decorator_list=[]), ClassDef(name='Serializer', bases=[], keywords=[], body=[Assign(targets=[Name(id='ANCHOR_TEMPLATE', ctx=Store())], value=Constant(value='id%03d')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='encoding'), arg(arg='explicit_start'), arg(arg='explicit_end'), arg(arg='version'), arg(arg='tags')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=None), Constant(value=None), Constant(value=None), Constant(value=None), Constant(value=None)]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='use_encoding', ctx=Store())], value=Name(id='encoding', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='use_explicit_start', ctx=Store())], value=Name(id='explicit_start', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='use_explicit_end', ctx=Store())], value=Name(id='explicit_end', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='use_version', ctx=Store())], value=Name(id='version', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='use_tags', ctx=Store())], value=Name(id='tags', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='serialized_nodes', ctx=Store())], value=Dict(keys=[], values=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Store())], value=Dict(keys=[], values=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='last_anchor_id', ctx=Store())], value=Constant(value=0)), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='closed', ctx=Store())], value=Constant(value=None))], decorator_list=[]), FunctionDef(name='open', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='closed', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='StreamStartEvent', ctx=Load()), args=[], keywords=[keyword(arg='encoding', value=Attribute(value=Name(id='self', ctx=Load()), attr='use_encoding', ctx=Load()))])], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='closed', ctx=Store())], value=Constant(value=False))], orelse=[If(test=Attribute(value=Name(id='self', ctx=Load()), attr='closed', ctx=Load()), body=[Raise(exc=Call(func=Name(id='SerializerError', ctx=Load()), args=[Constant(value='serializer is closed')], keywords=[]))], orelse=[Raise(exc=Call(func=Name(id='SerializerError', ctx=Load()), args=[Constant(value='serializer is already opened')], keywords=[]))])])], decorator_list=[]), FunctionDef(name='close', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='closed', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=[Raise(exc=Call(func=Name(id='SerializerError', ctx=Load()), args=[Constant(value='serializer is not opened')], keywords=[]))], orelse=[If(test=UnaryOp(op=Not(), operand=Attribute(value=Name(id='self', ctx=Load()), attr='closed', ctx=Load())), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='StreamEndEvent', ctx=Load()), args=[], keywords=[])], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='closed', ctx=Store())], value=Constant(value=True))], orelse=[])])], decorator_list=[]), FunctionDef(name='serialize', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='node')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='closed', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=[Raise(exc=Call(func=Name(id='SerializerError', ctx=Load()), args=[Constant(value='serializer is not opened')], keywords=[]))], orelse=[If(test=Attribute(value=Name(id='self', ctx=Load()), attr='closed', ctx=Load()), body=[Raise(exc=Call(func=Name(id='SerializerError', ctx=Load()), args=[Constant(value='serializer is closed')], keywords=[]))], orelse=[])]), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='DocumentStartEvent', ctx=Load()), args=[], keywords=[keyword(arg='explicit', value=Attribute(value=Name(id='self', ctx=Load()), attr='use_explicit_start', ctx=Load())), keyword(arg='version', value=Attribute(value=Name(id='self', ctx=Load()), attr='use_version', ctx=Load())), keyword(arg='tags', value=Attribute(value=Name(id='self', ctx=Load()), attr='use_tags', ctx=Load()))])], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='anchor_node', ctx=Load()), args=[Name(id='node', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='serialize_node', ctx=Load()), args=[Name(id='node', ctx=Load()), Constant(value=None), Constant(value=None)], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='DocumentEndEvent', ctx=Load()), args=[], keywords=[keyword(arg='explicit', value=Attribute(value=Name(id='self', ctx=Load()), attr='use_explicit_end', ctx=Load()))])], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='serialized_nodes', ctx=Store())], value=Dict(keys=[], values=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Store())], value=Dict(keys=[], values=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='last_anchor_id', ctx=Store())], value=Constant(value=0))], decorator_list=[]), FunctionDef(name='anchor_node', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='node')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Compare(left=Name(id='node', ctx=Load()), ops=[In()], comparators=[Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load())]), body=[If(test=Compare(left=Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load()), slice=Name(id='node', ctx=Load()), ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=[Assign(targets=[Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load()), slice=Name(id='node', ctx=Load()), ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='generate_anchor', ctx=Load()), args=[Name(id='node', ctx=Load())], keywords=[]))], orelse=[])], orelse=[Assign(targets=[Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load()), slice=Name(id='node', ctx=Load()), ctx=Store())], value=Constant(value=None)), If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='node', ctx=Load()), Name(id='SequenceNode', ctx=Load())], keywords=[]), body=[For(target=Name(id='item', ctx=Store()), iter=Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='anchor_node', ctx=Load()), args=[Name(id='item', ctx=Load())], keywords=[]))], orelse=[])], orelse=[If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='node', ctx=Load()), Name(id='MappingNode', ctx=Load())], keywords=[]), body=[For(target=Tuple(elts=[Name(id='key', ctx=Store()), Name(id='value', ctx=Store())], ctx=Store()), iter=Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='anchor_node', ctx=Load()), args=[Name(id='key', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='anchor_node', ctx=Load()), args=[Name(id='value', ctx=Load())], keywords=[]))], orelse=[])], orelse=[])])])], decorator_list=[]), FunctionDef(name='generate_anchor', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='node')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[AugAssign(target=Attribute(value=Name(id='self', ctx=Load()), attr='last_anchor_id', ctx=Store()), op=Add(), value=Constant(value=1)), Return(value=BinOp(left=Attribute(value=Name(id='self', ctx=Load()), attr='ANCHOR_TEMPLATE', ctx=Load()), op=Mod(), right=Attribute(value=Name(id='self', ctx=Load()), attr='last_anchor_id', ctx=Load())))], decorator_list=[]), FunctionDef(name='serialize_node', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='node'), arg(arg='parent'), arg(arg='index')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='alias', ctx=Store())], value=Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='anchors', ctx=Load()), slice=Name(id='node', ctx=Load()), ctx=Load())), If(test=Compare(left=Name(id='node', ctx=Load()), ops=[In()], comparators=[Attribute(value=Name(id='self', ctx=Load()), attr='serialized_nodes', ctx=Load())]), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='AliasEvent', ctx=Load()), args=[Name(id='alias', ctx=Load())], keywords=[])], keywords=[]))], orelse=[Assign(targets=[Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='serialized_nodes', ctx=Load()), slice=Name(id='node', ctx=Load()), ctx=Store())], value=Constant(value=True)), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='descend_resolver', ctx=Load()), args=[Name(id='parent', ctx=Load()), Name(id='index', ctx=Load())], keywords=[])), If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='node', ctx=Load()), Name(id='ScalarNode', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='detected_tag', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='resolve', ctx=Load()), args=[Name(id='ScalarNode', ctx=Load()), Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), Tuple(elts=[Constant(value=True), Constant(value=False)], ctx=Load())], keywords=[])), Assign(targets=[Name(id='default_tag', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='resolve', ctx=Load()), args=[Name(id='ScalarNode', ctx=Load()), Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), Tuple(elts=[Constant(value=False), Constant(value=True)], ctx=Load())], keywords=[])), Assign(targets=[Name(id='implicit', ctx=Store())], value=Tuple(elts=[Compare(left=Attribute(value=Name(id='node', ctx=Load()), attr='tag', ctx=Load()), ops=[Eq()], comparators=[Name(id='detected_tag', ctx=Load())]), Compare(left=Attribute(value=Name(id='node', ctx=Load()), attr='tag', ctx=Load()), ops=[Eq()], comparators=[Name(id='default_tag', ctx=Load())])], ctx=Load())), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='ScalarEvent', ctx=Load()), args=[Name(id='alias', ctx=Load()), Attribute(value=Name(id='node', ctx=Load()), attr='tag', ctx=Load()), Name(id='implicit', ctx=Load()), Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load())], keywords=[keyword(arg='style', value=Attribute(value=Name(id='node', ctx=Load()), attr='style', ctx=Load()))])], keywords=[]))], orelse=[If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='node', ctx=Load()), Name(id='SequenceNode', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='implicit', ctx=Store())], value=Compare(left=Attribute(value=Name(id='node', ctx=Load()), attr='tag', ctx=Load()), ops=[Eq()], comparators=[Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='resolve', ctx=Load()), args=[Name(id='SequenceNode', ctx=Load()), Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), Constant(value=True)], keywords=[])])), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='SequenceStartEvent', ctx=Load()), args=[Name(id='alias', ctx=Load()), Attribute(value=Name(id='node', ctx=Load()), attr='tag', ctx=Load()), Name(id='implicit', ctx=Load())], keywords=[keyword(arg='flow_style', value=Attribute(value=Name(id='node', ctx=Load()), attr='flow_style', ctx=Load()))])], keywords=[])), Assign(targets=[Name(id='index', ctx=Store())], value=Constant(value=0)), For(target=Name(id='item', ctx=Store()), iter=Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='serialize_node', ctx=Load()), args=[Name(id='item', ctx=Load()), Name(id='node', ctx=Load()), Name(id='index', ctx=Load())], keywords=[])), AugAssign(target=Name(id='index', ctx=Store()), op=Add(), value=Constant(value=1))], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='SequenceEndEvent', ctx=Load()), args=[], keywords=[])], keywords=[]))], orelse=[If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='node', ctx=Load()), Name(id='MappingNode', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='implicit', ctx=Store())], value=Compare(left=Attribute(value=Name(id='node', ctx=Load()), attr='tag', ctx=Load()), ops=[Eq()], comparators=[Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='resolve', ctx=Load()), args=[Name(id='MappingNode', ctx=Load()), Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), Constant(value=True)], keywords=[])])), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='MappingStartEvent', ctx=Load()), args=[Name(id='alias', ctx=Load()), Attribute(value=Name(id='node', ctx=Load()), attr='tag', ctx=Load()), Name(id='implicit', ctx=Load())], keywords=[keyword(arg='flow_style', value=Attribute(value=Name(id='node', ctx=Load()), attr='flow_style', ctx=Load()))])], keywords=[])), For(target=Tuple(elts=[Name(id='key', ctx=Store()), Name(id='value', ctx=Store())], ctx=Store()), iter=Attribute(value=Name(id='node', ctx=Load()), attr='value', ctx=Load()), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='serialize_node', ctx=Load()), args=[Name(id='key', ctx=Load()), Name(id='node', ctx=Load()), Constant(value=None)], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='serialize_node', ctx=Load()), args=[Name(id='value', ctx=Load()), Name(id='node', ctx=Load()), Name(id='key', ctx=Load())], keywords=[]))], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='emit', ctx=Load()), args=[Call(func=Name(id='MappingEndEvent', ctx=Load()), args=[], keywords=[])], keywords=[]))], orelse=[])])]), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='ascend_resolver', ctx=Load()), args=[], keywords=[]))])], decorator_list=[])], decorator_list=[])], type_ignores=[])