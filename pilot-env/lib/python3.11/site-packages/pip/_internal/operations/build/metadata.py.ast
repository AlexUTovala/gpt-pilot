Module(body=[Expr(value=Constant(value='Metadata generation logic for source distributions.\n')), Import(names=[alias(name='os')]), ImportFrom(module='pip._vendor.pyproject_hooks', names=[alias(name='BuildBackendHookCaller')], level=0), ImportFrom(module='pip._internal.build_env', names=[alias(name='BuildEnvironment')], level=0), ImportFrom(module='pip._internal.exceptions', names=[alias(name='InstallationSubprocessError'), alias(name='MetadataGenerationFailed')], level=0), ImportFrom(module='pip._internal.utils.subprocess', names=[alias(name='runner_with_spinner_message')], level=0), ImportFrom(module='pip._internal.utils.temp_dir', names=[alias(name='TempDirectory')], level=0), FunctionDef(name='generate_metadata', args=arguments(posonlyargs=[], args=[arg(arg='build_env', annotation=Name(id='BuildEnvironment', ctx=Load())), arg(arg='backend', annotation=Name(id='BuildBackendHookCaller', ctx=Load())), arg(arg='details', annotation=Name(id='str', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Generate metadata using mechanisms described in PEP 517.\n\n    Returns the generated metadata directory.\n    ')), Assign(targets=[Name(id='metadata_tmpdir', ctx=Store())], value=Call(func=Name(id='TempDirectory', ctx=Load()), args=[], keywords=[keyword(arg='kind', value=Constant(value='modern-metadata')), keyword(arg='globally_managed', value=Constant(value=True))])), Assign(targets=[Name(id='metadata_dir', ctx=Store())], value=Attribute(value=Name(id='metadata_tmpdir', ctx=Load()), attr='path', ctx=Load())), With(items=[withitem(context_expr=Name(id='build_env', ctx=Load()))], body=[Assign(targets=[Name(id='runner', ctx=Store())], value=Call(func=Name(id='runner_with_spinner_message', ctx=Load()), args=[Constant(value='Preparing metadata (pyproject.toml)')], keywords=[])), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='backend', ctx=Load()), attr='subprocess_runner', ctx=Load()), args=[Name(id='runner', ctx=Load())], keywords=[]))], body=[Try(body=[Assign(targets=[Name(id='distinfo_dir', ctx=Store())], value=Call(func=Attribute(value=Name(id='backend', ctx=Load()), attr='prepare_metadata_for_build_wheel', ctx=Load()), args=[Name(id='metadata_dir', ctx=Load())], keywords=[]))], handlers=[ExceptHandler(type=Name(id='InstallationSubprocessError', ctx=Load()), name='error', body=[Raise(exc=Call(func=Name(id='MetadataGenerationFailed', ctx=Load()), args=[], keywords=[keyword(arg='package_details', value=Name(id='details', ctx=Load()))]), cause=Name(id='error', ctx=Load()))])], orelse=[], finalbody=[])])]), Return(value=Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='join', ctx=Load()), args=[Name(id='metadata_dir', ctx=Load()), Name(id='distinfo_dir', ctx=Load())], keywords=[]))], decorator_list=[], returns=Name(id='str', ctx=Load()))], type_ignores=[])