Module(body=[Import(names=[alias(name='os')]), Import(names=[alias(name='platform')]), Import(names=[alias(name='socket')]), Import(names=[alias(name='ssl')]), Import(names=[alias(name='typing')]), Import(names=[alias(name='_ssl')]), ImportFrom(module='_ssl_constants', names=[alias(name='_original_SSLContext'), alias(name='_original_super_SSLContext'), alias(name='_truststore_SSLContext_dunder_class'), alias(name='_truststore_SSLContext_super_class')], level=1), If(test=Compare(left=Call(func=Attribute(value=Name(id='platform', ctx=Load()), attr='system', ctx=Load()), args=[], keywords=[]), ops=[Eq()], comparators=[Constant(value='Windows')]), body=[ImportFrom(module='_windows', names=[alias(name='_configure_context'), alias(name='_verify_peercerts_impl')], level=1)], orelse=[If(test=Compare(left=Call(func=Attribute(value=Name(id='platform', ctx=Load()), attr='system', ctx=Load()), args=[], keywords=[]), ops=[Eq()], comparators=[Constant(value='Darwin')]), body=[ImportFrom(module='_macos', names=[alias(name='_configure_context'), alias(name='_verify_peercerts_impl')], level=1)], orelse=[ImportFrom(module='_openssl', names=[alias(name='_configure_context'), alias(name='_verify_peercerts_impl')], level=1)])]), If(test=Attribute(value=Name(id='typing', ctx=Load()), attr='TYPE_CHECKING', ctx=Load()), body=[ImportFrom(module='pip._vendor.typing_extensions', names=[alias(name='Buffer')], level=0)], orelse=[]), AnnAssign(target=Name(id='_StrOrBytesPath', ctx=Store()), annotation=Attribute(value=Name(id='typing', ctx=Load()), attr='TypeAlias', ctx=Load()), value=BinOp(left=BinOp(left=BinOp(left=Name(id='str', ctx=Load()), op=BitOr(), right=Name(id='bytes', ctx=Load())), op=BitOr(), right=Subscript(value=Attribute(value=Name(id='os', ctx=Load()), attr='PathLike', ctx=Load()), slice=Name(id='str', ctx=Load()), ctx=Load())), op=BitOr(), right=Subscript(value=Attribute(value=Name(id='os', ctx=Load()), attr='PathLike', ctx=Load()), slice=Name(id='bytes', ctx=Load()), ctx=Load())), simple=1), AnnAssign(target=Name(id='_PasswordType', ctx=Store()), annotation=Attribute(value=Name(id='typing', ctx=Load()), attr='TypeAlias', ctx=Load()), value=BinOp(left=BinOp(left=Name(id='str', ctx=Load()), op=BitOr(), right=Name(id='bytes', ctx=Load())), op=BitOr(), right=Subscript(value=Attribute(value=Name(id='typing', ctx=Load()), attr='Callable', ctx=Load()), slice=Tuple(elts=[List(elts=[], ctx=Load()), BinOp(left=Name(id='str', ctx=Load()), op=BitOr(), right=Name(id='bytes', ctx=Load()))], ctx=Load()), ctx=Load())), simple=1), FunctionDef(name='inject_into_ssl', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Injects the :class:`truststore.SSLContext` into the ``ssl``\n    module by replacing :class:`ssl.SSLContext`.\n    ')), Expr(value=Call(func=Name(id='setattr', ctx=Load()), args=[Name(id='ssl', ctx=Load()), Constant(value='SSLContext'), Name(id='SSLContext', ctx=Load())], keywords=[])), Try(body=[Import(names=[alias(name='pip._vendor.urllib3.util.ssl_', asname='urllib3_ssl')]), Expr(value=Call(func=Name(id='setattr', ctx=Load()), args=[Name(id='urllib3_ssl', ctx=Load()), Constant(value='SSLContext'), Name(id='SSLContext', ctx=Load())], keywords=[]))], handlers=[ExceptHandler(type=Name(id='ImportError', ctx=Load()), body=[Pass()])], orelse=[], finalbody=[])], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='extract_from_ssl', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Restores the :class:`ssl.SSLContext` class to its original state')), Expr(value=Call(func=Name(id='setattr', ctx=Load()), args=[Name(id='ssl', ctx=Load()), Constant(value='SSLContext'), Name(id='_original_SSLContext', ctx=Load())], keywords=[])), Try(body=[Import(names=[alias(name='pip._vendor.urllib3.util.ssl_', asname='urllib3_ssl')]), Assign(targets=[Attribute(value=Name(id='urllib3_ssl', ctx=Load()), attr='SSLContext', ctx=Store())], value=Name(id='_original_SSLContext', ctx=Load()))], handlers=[ExceptHandler(type=Name(id='ImportError', ctx=Load()), body=[Pass()])], orelse=[], finalbody=[])], decorator_list=[], returns=Constant(value=None)), ClassDef(name='SSLContext', bases=[Name(id='_truststore_SSLContext_super_class', ctx=Load())], keywords=[], body=[Expr(value=Constant(value='SSLContext API that uses system certificates on all platforms')), FunctionDef(name='__class__', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=BoolOp(op=Or(), values=[Name(id='_truststore_SSLContext_dunder_class', ctx=Load()), Name(id='SSLContext', ctx=Load())]))], decorator_list=[Name(id='property', ctx=Load())], returns=Name(id='type', ctx=Load())), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='protocol', annotation=Name(id='int', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=None)]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Store())], value=Call(func=Name(id='_original_SSLContext', ctx=Load()), args=[Name(id='protocol', ctx=Load())], keywords=[])), ClassDef(name='TruststoreSSLObject', bases=[Attribute(value=Name(id='ssl', ctx=Load()), attr='SSLObject', ctx=Load())], keywords=[], body=[FunctionDef(name='do_handshake', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='ret', ctx=Store())], value=Call(func=Attribute(value=Call(func=Name(id='super', ctx=Load()), args=[], keywords=[]), attr='do_handshake', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Name(id='_verify_peercerts', ctx=Load()), args=[Name(id='self', ctx=Load())], keywords=[keyword(arg='server_hostname', value=Attribute(value=Name(id='self', ctx=Load()), attr='server_hostname', ctx=Load()))])), Return(value=Name(id='ret', ctx=Load()))], decorator_list=[], returns=Constant(value=None))], decorator_list=[]), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='sslobject_class', ctx=Store())], value=Name(id='TruststoreSSLObject', ctx=Load()))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='wrap_socket', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='sock', annotation=Attribute(value=Name(id='socket', ctx=Load()), attr='socket', ctx=Load())), arg(arg='server_side', annotation=Name(id='bool', ctx=Load())), arg(arg='do_handshake_on_connect', annotation=Name(id='bool', ctx=Load())), arg(arg='suppress_ragged_eofs', annotation=Name(id='bool', ctx=Load())), arg(arg='server_hostname', annotation=BinOp(left=Name(id='str', ctx=Load()), op=BitOr(), right=Constant(value=None))), arg(arg='session', annotation=BinOp(left=Attribute(value=Name(id='ssl', ctx=Load()), attr='SSLSession', ctx=Load()), op=BitOr(), right=Constant(value=None)))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=False), Constant(value=True), Constant(value=True), Constant(value=None), Constant(value=None)]), body=[With(items=[withitem(context_expr=Call(func=Name(id='_configure_context', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load())], keywords=[]))], body=[Assign(targets=[Name(id='ssl_sock', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='wrap_socket', ctx=Load()), args=[Name(id='sock', ctx=Load())], keywords=[keyword(arg='server_side', value=Name(id='server_side', ctx=Load())), keyword(arg='server_hostname', value=Name(id='server_hostname', ctx=Load())), keyword(arg='do_handshake_on_connect', value=Name(id='do_handshake_on_connect', ctx=Load())), keyword(arg='suppress_ragged_eofs', value=Name(id='suppress_ragged_eofs', ctx=Load())), keyword(arg='session', value=Name(id='session', ctx=Load()))]))]), Try(body=[Expr(value=Call(func=Name(id='_verify_peercerts', ctx=Load()), args=[Name(id='ssl_sock', ctx=Load())], keywords=[keyword(arg='server_hostname', value=Name(id='server_hostname', ctx=Load()))]))], handlers=[ExceptHandler(type=Name(id='Exception', ctx=Load()), body=[Expr(value=Call(func=Attribute(value=Name(id='ssl_sock', ctx=Load()), attr='close', ctx=Load()), args=[], keywords=[])), Raise()])], orelse=[], finalbody=[]), Return(value=Name(id='ssl_sock', ctx=Load()))], decorator_list=[], returns=Attribute(value=Name(id='ssl', ctx=Load()), attr='SSLSocket', ctx=Load())), FunctionDef(name='wrap_bio', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='incoming', annotation=Attribute(value=Name(id='ssl', ctx=Load()), attr='MemoryBIO', ctx=Load())), arg(arg='outgoing', annotation=Attribute(value=Name(id='ssl', ctx=Load()), attr='MemoryBIO', ctx=Load())), arg(arg='server_side', annotation=Name(id='bool', ctx=Load())), arg(arg='server_hostname', annotation=BinOp(left=Name(id='str', ctx=Load()), op=BitOr(), right=Constant(value=None))), arg(arg='session', annotation=BinOp(left=Attribute(value=Name(id='ssl', ctx=Load()), attr='SSLSession', ctx=Load()), op=BitOr(), right=Constant(value=None)))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=False), Constant(value=None), Constant(value=None)]), body=[With(items=[withitem(context_expr=Call(func=Name(id='_configure_context', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load())], keywords=[]))], body=[Assign(targets=[Name(id='ssl_obj', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='wrap_bio', ctx=Load()), args=[Name(id='incoming', ctx=Load()), Name(id='outgoing', ctx=Load())], keywords=[keyword(arg='server_hostname', value=Name(id='server_hostname', ctx=Load())), keyword(arg='server_side', value=Name(id='server_side', ctx=Load())), keyword(arg='session', value=Name(id='session', ctx=Load()))]))]), Return(value=Name(id='ssl_obj', ctx=Load()))], decorator_list=[], returns=Attribute(value=Name(id='ssl', ctx=Load()), attr='SSLObject', ctx=Load())), FunctionDef(name='load_verify_locations', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='cafile', annotation=BinOp(left=BinOp(left=BinOp(left=BinOp(left=Name(id='str', ctx=Load()), op=BitOr(), right=Name(id='bytes', ctx=Load())), op=BitOr(), right=Subscript(value=Attribute(value=Name(id='os', ctx=Load()), attr='PathLike', ctx=Load()), slice=Name(id='str', ctx=Load()), ctx=Load())), op=BitOr(), right=Subscript(value=Attribute(value=Name(id='os', ctx=Load()), attr='PathLike', ctx=Load()), slice=Name(id='bytes', ctx=Load()), ctx=Load())), op=BitOr(), right=Constant(value=None))), arg(arg='capath', annotation=BinOp(left=BinOp(left=BinOp(left=BinOp(left=Name(id='str', ctx=Load()), op=BitOr(), right=Name(id='bytes', ctx=Load())), op=BitOr(), right=Subscript(value=Attribute(value=Name(id='os', ctx=Load()), attr='PathLike', ctx=Load()), slice=Name(id='str', ctx=Load()), ctx=Load())), op=BitOr(), right=Subscript(value=Attribute(value=Name(id='os', ctx=Load()), attr='PathLike', ctx=Load()), slice=Name(id='bytes', ctx=Load()), ctx=Load())), op=BitOr(), right=Constant(value=None))), arg(arg='cadata', annotation=Subscript(value=Attribute(value=Name(id='typing', ctx=Load()), attr='Union', ctx=Load()), slice=Tuple(elts=[Name(id='str', ctx=Load()), Constant(value='Buffer'), Constant(value=None)], ctx=Load()), ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=None), Constant(value=None), Constant(value=None)]), body=[Return(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='load_verify_locations', ctx=Load()), args=[], keywords=[keyword(arg='cafile', value=Name(id='cafile', ctx=Load())), keyword(arg='capath', value=Name(id='capath', ctx=Load())), keyword(arg='cadata', value=Name(id='cadata', ctx=Load()))]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='load_cert_chain', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='certfile', annotation=Name(id='_StrOrBytesPath', ctx=Load())), arg(arg='keyfile', annotation=BinOp(left=Name(id='_StrOrBytesPath', ctx=Load()), op=BitOr(), right=Constant(value=None))), arg(arg='password', annotation=BinOp(left=Name(id='_PasswordType', ctx=Load()), op=BitOr(), right=Constant(value=None)))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=None), Constant(value=None)]), body=[Return(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='load_cert_chain', ctx=Load()), args=[], keywords=[keyword(arg='certfile', value=Name(id='certfile', ctx=Load())), keyword(arg='keyfile', value=Name(id='keyfile', ctx=Load())), keyword(arg='password', value=Name(id='password', ctx=Load()))]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='load_default_certs', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='purpose', annotation=Attribute(value=Name(id='ssl', ctx=Load()), attr='Purpose', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Attribute(value=Attribute(value=Name(id='ssl', ctx=Load()), attr='Purpose', ctx=Load()), attr='SERVER_AUTH', ctx=Load())]), body=[Return(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='load_default_certs', ctx=Load()), args=[Name(id='purpose', ctx=Load())], keywords=[]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='set_alpn_protocols', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='alpn_protocols', annotation=Subscript(value=Attribute(value=Name(id='typing', ctx=Load()), attr='Iterable', ctx=Load()), slice=Name(id='str', ctx=Load()), ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='set_alpn_protocols', ctx=Load()), args=[Name(id='alpn_protocols', ctx=Load())], keywords=[]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='set_npn_protocols', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='npn_protocols', annotation=Subscript(value=Attribute(value=Name(id='typing', ctx=Load()), attr='Iterable', ctx=Load()), slice=Name(id='str', ctx=Load()), ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='set_npn_protocols', ctx=Load()), args=[Name(id='npn_protocols', ctx=Load())], keywords=[]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='set_ciphers', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='__cipherlist', annotation=Name(id='str', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='set_ciphers', ctx=Load()), args=[Name(id='__cipherlist', ctx=Load())], keywords=[]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='get_ciphers', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='get_ciphers', ctx=Load()), args=[], keywords=[]))], decorator_list=[], returns=Attribute(value=Name(id='typing', ctx=Load()), attr='Any', ctx=Load())), FunctionDef(name='session_stats', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='session_stats', ctx=Load()), args=[], keywords=[]))], decorator_list=[], returns=Subscript(value=Name(id='dict', ctx=Load()), slice=Tuple(elts=[Name(id='str', ctx=Load()), Name(id='int', ctx=Load())], ctx=Load()), ctx=Load())), FunctionDef(name='cert_store_stats', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Raise(exc=Call(func=Name(id='NotImplementedError', ctx=Load()), args=[], keywords=[]))], decorator_list=[], returns=Subscript(value=Name(id='dict', ctx=Load()), slice=Tuple(elts=[Name(id='str', ctx=Load()), Name(id='int', ctx=Load())], ctx=Load()), ctx=Load())), FunctionDef(name='get_ca_certs', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='binary_form', annotation=Subscript(value=Attribute(value=Name(id='typing', ctx=Load()), attr='Literal', ctx=Load()), slice=Constant(value=False), ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=Ellipsis)]), body=[Expr(value=Constant(value=Ellipsis))], decorator_list=[Attribute(value=Name(id='typing', ctx=Load()), attr='overload', ctx=Load())], returns=Subscript(value=Name(id='list', ctx=Load()), slice=Attribute(value=Name(id='typing', ctx=Load()), attr='Any', ctx=Load()), ctx=Load())), FunctionDef(name='get_ca_certs', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='binary_form', annotation=Subscript(value=Attribute(value=Name(id='typing', ctx=Load()), attr='Literal', ctx=Load()), slice=Constant(value=True), ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=Ellipsis)]), body=[Expr(value=Constant(value=Ellipsis))], decorator_list=[Attribute(value=Name(id='typing', ctx=Load()), attr='overload', ctx=Load())], returns=Subscript(value=Name(id='list', ctx=Load()), slice=Name(id='bytes', ctx=Load()), ctx=Load())), FunctionDef(name='get_ca_certs', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='binary_form', annotation=Name(id='bool', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=Ellipsis)]), body=[Expr(value=Constant(value=Ellipsis))], decorator_list=[Attribute(value=Name(id='typing', ctx=Load()), attr='overload', ctx=Load())], returns=Attribute(value=Name(id='typing', ctx=Load()), attr='Any', ctx=Load())), FunctionDef(name='get_ca_certs', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='binary_form', annotation=Name(id='bool', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=False)]), body=[Raise(exc=Call(func=Name(id='NotImplementedError', ctx=Load()), args=[], keywords=[]))], decorator_list=[], returns=BinOp(left=Subscript(value=Name(id='list', ctx=Load()), slice=Attribute(value=Name(id='typing', ctx=Load()), attr='Any', ctx=Load()), ctx=Load()), op=BitOr(), right=Subscript(value=Name(id='list', ctx=Load()), slice=Name(id='bytes', ctx=Load()), ctx=Load()))), FunctionDef(name='check_hostname', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='check_hostname', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Name(id='bool', ctx=Load())), FunctionDef(name='check_hostname', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='value', annotation=Name(id='bool', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='check_hostname', ctx=Store())], value=Name(id='value', ctx=Load()))], decorator_list=[Attribute(value=Name(id='check_hostname', ctx=Load()), attr='setter', ctx=Load())], returns=Constant(value=None)), FunctionDef(name='hostname_checks_common_name', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='hostname_checks_common_name', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Name(id='bool', ctx=Load())), FunctionDef(name='hostname_checks_common_name', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='value', annotation=Name(id='bool', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='hostname_checks_common_name', ctx=Store())], value=Name(id='value', ctx=Load()))], decorator_list=[Attribute(value=Name(id='hostname_checks_common_name', ctx=Load()), attr='setter', ctx=Load())], returns=Constant(value=None)), FunctionDef(name='keylog_filename', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='keylog_filename', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Name(id='str', ctx=Load())), FunctionDef(name='keylog_filename', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='value', annotation=Name(id='str', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='keylog_filename', ctx=Store())], value=Name(id='value', ctx=Load()))], decorator_list=[Attribute(value=Name(id='keylog_filename', ctx=Load()), attr='setter', ctx=Load())], returns=Constant(value=None)), FunctionDef(name='maximum_version', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='maximum_version', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Attribute(value=Name(id='ssl', ctx=Load()), attr='TLSVersion', ctx=Load())), FunctionDef(name='maximum_version', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='value', annotation=Attribute(value=Name(id='ssl', ctx=Load()), attr='TLSVersion', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='_original_super_SSLContext', ctx=Load()), attr='maximum_version', ctx=Load()), attr='__set__', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), Name(id='value', ctx=Load())], keywords=[]))], decorator_list=[Attribute(value=Name(id='maximum_version', ctx=Load()), attr='setter', ctx=Load())], returns=Constant(value=None)), FunctionDef(name='minimum_version', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='minimum_version', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Attribute(value=Name(id='ssl', ctx=Load()), attr='TLSVersion', ctx=Load())), FunctionDef(name='minimum_version', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='value', annotation=Attribute(value=Name(id='ssl', ctx=Load()), attr='TLSVersion', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='_original_super_SSLContext', ctx=Load()), attr='minimum_version', ctx=Load()), attr='__set__', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), Name(id='value', ctx=Load())], keywords=[]))], decorator_list=[Attribute(value=Name(id='minimum_version', ctx=Load()), attr='setter', ctx=Load())], returns=Constant(value=None)), FunctionDef(name='options', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='options', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Attribute(value=Name(id='ssl', ctx=Load()), attr='Options', ctx=Load())), FunctionDef(name='options', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='value', annotation=Attribute(value=Name(id='ssl', ctx=Load()), attr='Options', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='_original_super_SSLContext', ctx=Load()), attr='options', ctx=Load()), attr='__set__', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), Name(id='value', ctx=Load())], keywords=[]))], decorator_list=[Attribute(value=Name(id='options', ctx=Load()), attr='setter', ctx=Load())], returns=Constant(value=None)), FunctionDef(name='post_handshake_auth', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='post_handshake_auth', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Name(id='bool', ctx=Load())), FunctionDef(name='post_handshake_auth', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='value', annotation=Name(id='bool', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='post_handshake_auth', ctx=Store())], value=Name(id='value', ctx=Load()))], decorator_list=[Attribute(value=Name(id='post_handshake_auth', ctx=Load()), attr='setter', ctx=Load())], returns=Constant(value=None)), FunctionDef(name='protocol', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='protocol', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Attribute(value=Name(id='ssl', ctx=Load()), attr='_SSLMethod', ctx=Load())), FunctionDef(name='security_level', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='security_level', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Name(id='int', ctx=Load())), FunctionDef(name='verify_flags', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='verify_flags', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Attribute(value=Name(id='ssl', ctx=Load()), attr='VerifyFlags', ctx=Load())), FunctionDef(name='verify_flags', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='value', annotation=Attribute(value=Name(id='ssl', ctx=Load()), attr='VerifyFlags', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='_original_super_SSLContext', ctx=Load()), attr='verify_flags', ctx=Load()), attr='__set__', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), Name(id='value', ctx=Load())], keywords=[]))], decorator_list=[Attribute(value=Name(id='verify_flags', ctx=Load()), attr='setter', ctx=Load())], returns=Constant(value=None)), FunctionDef(name='verify_mode', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), attr='verify_mode', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())], returns=Attribute(value=Name(id='ssl', ctx=Load()), attr='VerifyMode', ctx=Load())), FunctionDef(name='verify_mode', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='value', annotation=Attribute(value=Name(id='ssl', ctx=Load()), attr='VerifyMode', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='_original_super_SSLContext', ctx=Load()), attr='verify_mode', ctx=Load()), attr='__set__', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_ctx', ctx=Load()), Name(id='value', ctx=Load())], keywords=[]))], decorator_list=[Attribute(value=Name(id='verify_mode', ctx=Load()), attr='setter', ctx=Load())], returns=Constant(value=None))], decorator_list=[]), FunctionDef(name='_verify_peercerts', args=arguments(posonlyargs=[], args=[arg(arg='sock_or_sslobj', annotation=BinOp(left=Attribute(value=Name(id='ssl', ctx=Load()), attr='SSLSocket', ctx=Load()), op=BitOr(), right=Attribute(value=Name(id='ssl', ctx=Load()), attr='SSLObject', ctx=Load()))), arg(arg='server_hostname', annotation=BinOp(left=Name(id='str', ctx=Load()), op=BitOr(), right=Constant(value=None)))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='\n    Verifies the peer certificates from an SSLSocket or SSLObject\n    against the certificates in the OS trust store.\n    ')), AnnAssign(target=Name(id='sslobj', ctx=Store()), annotation=Attribute(value=Name(id='ssl', ctx=Load()), attr='SSLObject', ctx=Load()), value=Name(id='sock_or_sslobj', ctx=Load()), simple=1), Try(body=[While(test=UnaryOp(op=Not(), operand=Call(func=Name(id='hasattr', ctx=Load()), args=[Name(id='sslobj', ctx=Load()), Constant(value='get_unverified_chain')], keywords=[])), body=[Assign(targets=[Name(id='sslobj', ctx=Store())], value=Attribute(value=Name(id='sslobj', ctx=Load()), attr='_sslobj', ctx=Load()))], orelse=[])], handlers=[ExceptHandler(type=Name(id='AttributeError', ctx=Load()), body=[Pass()])], orelse=[], finalbody=[]), AnnAssign(target=Name(id='unverified_chain', ctx=Store()), annotation=Subscript(value=Attribute(value=Name(id='typing', ctx=Load()), attr='Sequence', ctx=Load()), slice=Attribute(value=Name(id='_ssl', ctx=Load()), attr='Certificate', ctx=Load()), ctx=Load()), value=BoolOp(op=Or(), values=[Call(func=Attribute(value=Name(id='sslobj', ctx=Load()), attr='get_unverified_chain', ctx=Load()), args=[], keywords=[]), Tuple(elts=[], ctx=Load())]), simple=1), Assign(targets=[Name(id='cert_bytes', ctx=Store())], value=ListComp(elt=Call(func=Attribute(value=Name(id='cert', ctx=Load()), attr='public_bytes', ctx=Load()), args=[Attribute(value=Name(id='_ssl', ctx=Load()), attr='ENCODING_DER', ctx=Load())], keywords=[]), generators=[comprehension(target=Name(id='cert', ctx=Store()), iter=Name(id='unverified_chain', ctx=Load()), ifs=[], is_async=0)])), Expr(value=Call(func=Name(id='_verify_peercerts_impl', ctx=Load()), args=[Attribute(value=Name(id='sock_or_sslobj', ctx=Load()), attr='context', ctx=Load()), Name(id='cert_bytes', ctx=Load())], keywords=[keyword(arg='server_hostname', value=Name(id='server_hostname', ctx=Load()))]))], decorator_list=[], returns=Constant(value=None))], type_ignores=[])