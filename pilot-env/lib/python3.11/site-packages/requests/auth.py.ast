Module(body=[Expr(value=Constant(value='\nrequests.auth\n~~~~~~~~~~~~~\n\nThis module contains the authentication handlers for Requests.\n')), Import(names=[alias(name='hashlib')]), Import(names=[alias(name='os')]), Import(names=[alias(name='re')]), Import(names=[alias(name='threading')]), Import(names=[alias(name='time')]), Import(names=[alias(name='warnings')]), ImportFrom(module='base64', names=[alias(name='b64encode')], level=0), ImportFrom(module='_internal_utils', names=[alias(name='to_native_string')], level=1), ImportFrom(module='compat', names=[alias(name='basestring'), alias(name='str'), alias(name='urlparse')], level=1), ImportFrom(module='cookies', names=[alias(name='extract_cookies_to_jar')], level=1), ImportFrom(module='utils', names=[alias(name='parse_dict_header')], level=1), Assign(targets=[Name(id='CONTENT_TYPE_FORM_URLENCODED', ctx=Store())], value=Constant(value='application/x-www-form-urlencoded')), Assign(targets=[Name(id='CONTENT_TYPE_MULTI_PART', ctx=Store())], value=Constant(value='multipart/form-data')), FunctionDef(name='_basic_auth_str', args=arguments(posonlyargs=[], args=[arg(arg='username'), arg(arg='password')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Returns a Basic Auth string.')), If(test=UnaryOp(op=Not(), operand=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='username', ctx=Load()), Name(id='basestring', ctx=Load())], keywords=[])), body=[Expr(value=Call(func=Attribute(value=Name(id='warnings', ctx=Load()), attr='warn', ctx=Load()), args=[Call(func=Attribute(value=Constant(value="Non-string usernames will no longer be supported in Requests 3.0.0. Please convert the object you've passed in ({!r}) to a string or bytes object in the near future to avoid problems."), attr='format', ctx=Load()), args=[Name(id='username', ctx=Load())], keywords=[])], keywords=[keyword(arg='category', value=Name(id='DeprecationWarning', ctx=Load()))])), Assign(targets=[Name(id='username', ctx=Store())], value=Call(func=Name(id='str', ctx=Load()), args=[Name(id='username', ctx=Load())], keywords=[]))], orelse=[]), If(test=UnaryOp(op=Not(), operand=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='password', ctx=Load()), Name(id='basestring', ctx=Load())], keywords=[])), body=[Expr(value=Call(func=Attribute(value=Name(id='warnings', ctx=Load()), attr='warn', ctx=Load()), args=[Call(func=Attribute(value=Constant(value="Non-string passwords will no longer be supported in Requests 3.0.0. Please convert the object you've passed in ({!r}) to a string or bytes object in the near future to avoid problems."), attr='format', ctx=Load()), args=[Call(func=Name(id='type', ctx=Load()), args=[Name(id='password', ctx=Load())], keywords=[])], keywords=[])], keywords=[keyword(arg='category', value=Name(id='DeprecationWarning', ctx=Load()))])), Assign(targets=[Name(id='password', ctx=Store())], value=Call(func=Name(id='str', ctx=Load()), args=[Name(id='password', ctx=Load())], keywords=[]))], orelse=[]), If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='username', ctx=Load()), Name(id='str', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='username', ctx=Store())], value=Call(func=Attribute(value=Name(id='username', ctx=Load()), attr='encode', ctx=Load()), args=[Constant(value='latin1')], keywords=[]))], orelse=[]), If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='password', ctx=Load()), Name(id='str', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='password', ctx=Store())], value=Call(func=Attribute(value=Name(id='password', ctx=Load()), attr='encode', ctx=Load()), args=[Constant(value='latin1')], keywords=[]))], orelse=[]), Assign(targets=[Name(id='authstr', ctx=Store())], value=BinOp(left=Constant(value='Basic '), op=Add(), right=Call(func=Name(id='to_native_string', ctx=Load()), args=[Call(func=Attribute(value=Call(func=Name(id='b64encode', ctx=Load()), args=[Call(func=Attribute(value=Constant(value=b':'), attr='join', ctx=Load()), args=[Tuple(elts=[Name(id='username', ctx=Load()), Name(id='password', ctx=Load())], ctx=Load())], keywords=[])], keywords=[]), attr='strip', ctx=Load()), args=[], keywords=[])], keywords=[]))), Return(value=Name(id='authstr', ctx=Load()))], decorator_list=[]), ClassDef(name='AuthBase', bases=[], keywords=[], body=[Expr(value=Constant(value='Base class that all auth implementations derive from')), FunctionDef(name='__call__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='r')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Raise(exc=Call(func=Name(id='NotImplementedError', ctx=Load()), args=[Constant(value='Auth hooks must be callable.')], keywords=[]))], decorator_list=[])], decorator_list=[]), ClassDef(name='HTTPBasicAuth', bases=[Name(id='AuthBase', ctx=Load())], keywords=[], body=[Expr(value=Constant(value='Attaches HTTP Basic Authentication to the given Request object.')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='username'), arg(arg='password')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='username', ctx=Store())], value=Name(id='username', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='password', ctx=Store())], value=Name(id='password', ctx=Load()))], decorator_list=[]), FunctionDef(name='__eq__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='other')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Name(id='all', ctx=Load()), args=[List(elts=[Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='username', ctx=Load()), ops=[Eq()], comparators=[Call(func=Name(id='getattr', ctx=Load()), args=[Name(id='other', ctx=Load()), Constant(value='username'), Constant(value=None)], keywords=[])]), Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='password', ctx=Load()), ops=[Eq()], comparators=[Call(func=Name(id='getattr', ctx=Load()), args=[Name(id='other', ctx=Load()), Constant(value='password'), Constant(value=None)], keywords=[])])], ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='__ne__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='other')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=UnaryOp(op=Not(), operand=Compare(left=Name(id='self', ctx=Load()), ops=[Eq()], comparators=[Name(id='other', ctx=Load())])))], decorator_list=[]), FunctionDef(name='__call__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='r')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Subscript(value=Attribute(value=Name(id='r', ctx=Load()), attr='headers', ctx=Load()), slice=Constant(value='Authorization'), ctx=Store())], value=Call(func=Name(id='_basic_auth_str', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='username', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='password', ctx=Load())], keywords=[])), Return(value=Name(id='r', ctx=Load()))], decorator_list=[])], decorator_list=[]), ClassDef(name='HTTPProxyAuth', bases=[Name(id='HTTPBasicAuth', ctx=Load())], keywords=[], body=[Expr(value=Constant(value='Attaches HTTP Proxy Authentication to a given Request object.')), FunctionDef(name='__call__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='r')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Subscript(value=Attribute(value=Name(id='r', ctx=Load()), attr='headers', ctx=Load()), slice=Constant(value='Proxy-Authorization'), ctx=Store())], value=Call(func=Name(id='_basic_auth_str', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='username', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='password', ctx=Load())], keywords=[])), Return(value=Name(id='r', ctx=Load()))], decorator_list=[])], decorator_list=[]), ClassDef(name='HTTPDigestAuth', bases=[Name(id='AuthBase', ctx=Load())], keywords=[], body=[Expr(value=Constant(value='Attaches HTTP Digest Authentication to the given Request object.')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='username'), arg(arg='password')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='username', ctx=Store())], value=Name(id='username', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='password', ctx=Store())], value=Name(id='password', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Store())], value=Call(func=Attribute(value=Name(id='threading', ctx=Load()), attr='local', ctx=Load()), args=[], keywords=[]))], decorator_list=[]), FunctionDef(name='init_per_thread_state', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Name(id='hasattr', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), Constant(value='init')], keywords=[])), body=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='init', ctx=Store())], value=Constant(value=True)), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='last_nonce', ctx=Store())], value=Constant(value='')), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='nonce_count', ctx=Store())], value=Constant(value=0)), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='chal', ctx=Store())], value=Dict(keys=[], values=[])), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='pos', ctx=Store())], value=Constant(value=None)), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='num_401_calls', ctx=Store())], value=Constant(value=None))], orelse=[])], decorator_list=[]), FunctionDef(name='build_digest_header', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='method'), arg(arg='url')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='\n        :rtype: str\n        ')), Assign(targets=[Name(id='realm', ctx=Store())], value=Subscript(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='chal', ctx=Load()), slice=Constant(value='realm'), ctx=Load())), Assign(targets=[Name(id='nonce', ctx=Store())], value=Subscript(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='chal', ctx=Load()), slice=Constant(value='nonce'), ctx=Load())), Assign(targets=[Name(id='qop', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='chal', ctx=Load()), attr='get', ctx=Load()), args=[Constant(value='qop')], keywords=[])), Assign(targets=[Name(id='algorithm', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='chal', ctx=Load()), attr='get', ctx=Load()), args=[Constant(value='algorithm')], keywords=[])), Assign(targets=[Name(id='opaque', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='chal', ctx=Load()), attr='get', ctx=Load()), args=[Constant(value='opaque')], keywords=[])), Assign(targets=[Name(id='hash_utf8', ctx=Store())], value=Constant(value=None)), If(test=Compare(left=Name(id='algorithm', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=[Assign(targets=[Name(id='_algorithm', ctx=Store())], value=Constant(value='MD5'))], orelse=[Assign(targets=[Name(id='_algorithm', ctx=Store())], value=Call(func=Attribute(value=Name(id='algorithm', ctx=Load()), attr='upper', ctx=Load()), args=[], keywords=[]))]), If(test=BoolOp(op=Or(), values=[Compare(left=Name(id='_algorithm', ctx=Load()), ops=[Eq()], comparators=[Constant(value='MD5')]), Compare(left=Name(id='_algorithm', ctx=Load()), ops=[Eq()], comparators=[Constant(value='MD5-SESS')])]), body=[FunctionDef(name='md5_utf8', args=arguments(posonlyargs=[], args=[arg(arg='x')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='x', ctx=Load()), Name(id='str', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='x', ctx=Store())], value=Call(func=Attribute(value=Name(id='x', ctx=Load()), attr='encode', ctx=Load()), args=[Constant(value='utf-8')], keywords=[]))], orelse=[]), Return(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='hashlib', ctx=Load()), attr='md5', ctx=Load()), args=[Name(id='x', ctx=Load())], keywords=[]), attr='hexdigest', ctx=Load()), args=[], keywords=[]))], decorator_list=[]), Assign(targets=[Name(id='hash_utf8', ctx=Store())], value=Name(id='md5_utf8', ctx=Load()))], orelse=[If(test=Compare(left=Name(id='_algorithm', ctx=Load()), ops=[Eq()], comparators=[Constant(value='SHA')]), body=[FunctionDef(name='sha_utf8', args=arguments(posonlyargs=[], args=[arg(arg='x')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='x', ctx=Load()), Name(id='str', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='x', ctx=Store())], value=Call(func=Attribute(value=Name(id='x', ctx=Load()), attr='encode', ctx=Load()), args=[Constant(value='utf-8')], keywords=[]))], orelse=[]), Return(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='hashlib', ctx=Load()), attr='sha1', ctx=Load()), args=[Name(id='x', ctx=Load())], keywords=[]), attr='hexdigest', ctx=Load()), args=[], keywords=[]))], decorator_list=[]), Assign(targets=[Name(id='hash_utf8', ctx=Store())], value=Name(id='sha_utf8', ctx=Load()))], orelse=[If(test=Compare(left=Name(id='_algorithm', ctx=Load()), ops=[Eq()], comparators=[Constant(value='SHA-256')]), body=[FunctionDef(name='sha256_utf8', args=arguments(posonlyargs=[], args=[arg(arg='x')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='x', ctx=Load()), Name(id='str', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='x', ctx=Store())], value=Call(func=Attribute(value=Name(id='x', ctx=Load()), attr='encode', ctx=Load()), args=[Constant(value='utf-8')], keywords=[]))], orelse=[]), Return(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='hashlib', ctx=Load()), attr='sha256', ctx=Load()), args=[Name(id='x', ctx=Load())], keywords=[]), attr='hexdigest', ctx=Load()), args=[], keywords=[]))], decorator_list=[]), Assign(targets=[Name(id='hash_utf8', ctx=Store())], value=Name(id='sha256_utf8', ctx=Load()))], orelse=[If(test=Compare(left=Name(id='_algorithm', ctx=Load()), ops=[Eq()], comparators=[Constant(value='SHA-512')]), body=[FunctionDef(name='sha512_utf8', args=arguments(posonlyargs=[], args=[arg(arg='x')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='x', ctx=Load()), Name(id='str', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='x', ctx=Store())], value=Call(func=Attribute(value=Name(id='x', ctx=Load()), attr='encode', ctx=Load()), args=[Constant(value='utf-8')], keywords=[]))], orelse=[]), Return(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='hashlib', ctx=Load()), attr='sha512', ctx=Load()), args=[Name(id='x', ctx=Load())], keywords=[]), attr='hexdigest', ctx=Load()), args=[], keywords=[]))], decorator_list=[]), Assign(targets=[Name(id='hash_utf8', ctx=Store())], value=Name(id='sha512_utf8', ctx=Load()))], orelse=[])])])]), Assign(targets=[Name(id='KD', ctx=Store())], value=Lambda(args=arguments(posonlyargs=[], args=[arg(arg='s'), arg(arg='d')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=Call(func=Name(id='hash_utf8', ctx=Load()), args=[JoinedStr(values=[FormattedValue(value=Name(id='s', ctx=Load()), conversion=-1), Constant(value=':'), FormattedValue(value=Name(id='d', ctx=Load()), conversion=-1)])], keywords=[]))), If(test=Compare(left=Name(id='hash_utf8', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=[Return(value=Constant(value=None))], orelse=[]), Assign(targets=[Name(id='entdig', ctx=Store())], value=Constant(value=None)), Assign(targets=[Name(id='p_parsed', ctx=Store())], value=Call(func=Name(id='urlparse', ctx=Load()), args=[Name(id='url', ctx=Load())], keywords=[])), Assign(targets=[Name(id='path', ctx=Store())], value=BoolOp(op=Or(), values=[Attribute(value=Name(id='p_parsed', ctx=Load()), attr='path', ctx=Load()), Constant(value='/')])), If(test=Attribute(value=Name(id='p_parsed', ctx=Load()), attr='query', ctx=Load()), body=[AugAssign(target=Name(id='path', ctx=Store()), op=Add(), value=JoinedStr(values=[Constant(value='?'), FormattedValue(value=Attribute(value=Name(id='p_parsed', ctx=Load()), attr='query', ctx=Load()), conversion=-1)]))], orelse=[]), Assign(targets=[Name(id='A1', ctx=Store())], value=JoinedStr(values=[FormattedValue(value=Attribute(value=Name(id='self', ctx=Load()), attr='username', ctx=Load()), conversion=-1), Constant(value=':'), FormattedValue(value=Name(id='realm', ctx=Load()), conversion=-1), Constant(value=':'), FormattedValue(value=Attribute(value=Name(id='self', ctx=Load()), attr='password', ctx=Load()), conversion=-1)])), Assign(targets=[Name(id='A2', ctx=Store())], value=JoinedStr(values=[FormattedValue(value=Name(id='method', ctx=Load()), conversion=-1), Constant(value=':'), FormattedValue(value=Name(id='path', ctx=Load()), conversion=-1)])), Assign(targets=[Name(id='HA1', ctx=Store())], value=Call(func=Name(id='hash_utf8', ctx=Load()), args=[Name(id='A1', ctx=Load())], keywords=[])), Assign(targets=[Name(id='HA2', ctx=Store())], value=Call(func=Name(id='hash_utf8', ctx=Load()), args=[Name(id='A2', ctx=Load())], keywords=[])), If(test=Compare(left=Name(id='nonce', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='last_nonce', ctx=Load())]), body=[AugAssign(target=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='nonce_count', ctx=Store()), op=Add(), value=Constant(value=1))], orelse=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='nonce_count', ctx=Store())], value=Constant(value=1))]), Assign(targets=[Name(id='ncvalue', ctx=Store())], value=JoinedStr(values=[FormattedValue(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='nonce_count', ctx=Load()), conversion=-1, format_spec=JoinedStr(values=[Constant(value='08x')]))])), Assign(targets=[Name(id='s', ctx=Store())], value=Call(func=Attribute(value=Call(func=Name(id='str', ctx=Load()), args=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='nonce_count', ctx=Load())], keywords=[]), attr='encode', ctx=Load()), args=[Constant(value='utf-8')], keywords=[])), AugAssign(target=Name(id='s', ctx=Store()), op=Add(), value=Call(func=Attribute(value=Name(id='nonce', ctx=Load()), attr='encode', ctx=Load()), args=[Constant(value='utf-8')], keywords=[])), AugAssign(target=Name(id='s', ctx=Store()), op=Add(), value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='time', ctx=Load()), attr='ctime', ctx=Load()), args=[], keywords=[]), attr='encode', ctx=Load()), args=[Constant(value='utf-8')], keywords=[])), AugAssign(target=Name(id='s', ctx=Store()), op=Add(), value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='urandom', ctx=Load()), args=[Constant(value=8)], keywords=[])), Assign(targets=[Name(id='cnonce', ctx=Store())], value=Subscript(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='hashlib', ctx=Load()), attr='sha1', ctx=Load()), args=[Name(id='s', ctx=Load())], keywords=[]), attr='hexdigest', ctx=Load()), args=[], keywords=[]), slice=Slice(upper=Constant(value=16)), ctx=Load())), If(test=Compare(left=Name(id='_algorithm', ctx=Load()), ops=[Eq()], comparators=[Constant(value='MD5-SESS')]), body=[Assign(targets=[Name(id='HA1', ctx=Store())], value=Call(func=Name(id='hash_utf8', ctx=Load()), args=[JoinedStr(values=[FormattedValue(value=Name(id='HA1', ctx=Load()), conversion=-1), Constant(value=':'), FormattedValue(value=Name(id='nonce', ctx=Load()), conversion=-1), Constant(value=':'), FormattedValue(value=Name(id='cnonce', ctx=Load()), conversion=-1)])], keywords=[]))], orelse=[]), If(test=UnaryOp(op=Not(), operand=Name(id='qop', ctx=Load())), body=[Assign(targets=[Name(id='respdig', ctx=Store())], value=Call(func=Name(id='KD', ctx=Load()), args=[Name(id='HA1', ctx=Load()), JoinedStr(values=[FormattedValue(value=Name(id='nonce', ctx=Load()), conversion=-1), Constant(value=':'), FormattedValue(value=Name(id='HA2', ctx=Load()), conversion=-1)])], keywords=[]))], orelse=[If(test=BoolOp(op=Or(), values=[Compare(left=Name(id='qop', ctx=Load()), ops=[Eq()], comparators=[Constant(value='auth')]), Compare(left=Constant(value='auth'), ops=[In()], comparators=[Call(func=Attribute(value=Name(id='qop', ctx=Load()), attr='split', ctx=Load()), args=[Constant(value=',')], keywords=[])])]), body=[Assign(targets=[Name(id='noncebit', ctx=Store())], value=JoinedStr(values=[FormattedValue(value=Name(id='nonce', ctx=Load()), conversion=-1), Constant(value=':'), FormattedValue(value=Name(id='ncvalue', ctx=Load()), conversion=-1), Constant(value=':'), FormattedValue(value=Name(id='cnonce', ctx=Load()), conversion=-1), Constant(value=':auth:'), FormattedValue(value=Name(id='HA2', ctx=Load()), conversion=-1)])), Assign(targets=[Name(id='respdig', ctx=Store())], value=Call(func=Name(id='KD', ctx=Load()), args=[Name(id='HA1', ctx=Load()), Name(id='noncebit', ctx=Load())], keywords=[]))], orelse=[Return(value=Constant(value=None))])]), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='last_nonce', ctx=Store())], value=Name(id='nonce', ctx=Load())), Assign(targets=[Name(id='base', ctx=Store())], value=JoinedStr(values=[Constant(value='username="'), FormattedValue(value=Attribute(value=Name(id='self', ctx=Load()), attr='username', ctx=Load()), conversion=-1), Constant(value='", realm="'), FormattedValue(value=Name(id='realm', ctx=Load()), conversion=-1), Constant(value='", nonce="'), FormattedValue(value=Name(id='nonce', ctx=Load()), conversion=-1), Constant(value='", uri="'), FormattedValue(value=Name(id='path', ctx=Load()), conversion=-1), Constant(value='", response="'), FormattedValue(value=Name(id='respdig', ctx=Load()), conversion=-1), Constant(value='"')])), If(test=Name(id='opaque', ctx=Load()), body=[AugAssign(target=Name(id='base', ctx=Store()), op=Add(), value=JoinedStr(values=[Constant(value=', opaque="'), FormattedValue(value=Name(id='opaque', ctx=Load()), conversion=-1), Constant(value='"')]))], orelse=[]), If(test=Name(id='algorithm', ctx=Load()), body=[AugAssign(target=Name(id='base', ctx=Store()), op=Add(), value=JoinedStr(values=[Constant(value=', algorithm="'), FormattedValue(value=Name(id='algorithm', ctx=Load()), conversion=-1), Constant(value='"')]))], orelse=[]), If(test=Name(id='entdig', ctx=Load()), body=[AugAssign(target=Name(id='base', ctx=Store()), op=Add(), value=JoinedStr(values=[Constant(value=', digest="'), FormattedValue(value=Name(id='entdig', ctx=Load()), conversion=-1), Constant(value='"')]))], orelse=[]), If(test=Name(id='qop', ctx=Load()), body=[AugAssign(target=Name(id='base', ctx=Store()), op=Add(), value=JoinedStr(values=[Constant(value=', qop="auth", nc='), FormattedValue(value=Name(id='ncvalue', ctx=Load()), conversion=-1), Constant(value=', cnonce="'), FormattedValue(value=Name(id='cnonce', ctx=Load()), conversion=-1), Constant(value='"')]))], orelse=[]), Return(value=JoinedStr(values=[Constant(value='Digest '), FormattedValue(value=Name(id='base', ctx=Load()), conversion=-1)]))], decorator_list=[]), FunctionDef(name='handle_redirect', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='r')], kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[]), body=[Expr(value=Constant(value='Reset num_401_calls counter on redirects.')), If(test=Attribute(value=Name(id='r', ctx=Load()), attr='is_redirect', ctx=Load()), body=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='num_401_calls', ctx=Store())], value=Constant(value=1))], orelse=[])], decorator_list=[]), FunctionDef(name='handle_401', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='r')], kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[]), body=[Expr(value=Constant(value='\n        Takes the given response and tries digest-auth, if needed.\n\n        :rtype: requests.Response\n        ')), If(test=UnaryOp(op=Not(), operand=Compare(left=Constant(value=400), ops=[LtE(), Lt()], comparators=[Attribute(value=Name(id='r', ctx=Load()), attr='status_code', ctx=Load()), Constant(value=500)])), body=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='num_401_calls', ctx=Store())], value=Constant(value=1)), Return(value=Name(id='r', ctx=Load()))], orelse=[]), If(test=Compare(left=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='pos', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), body=[Expr(value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='r', ctx=Load()), attr='request', ctx=Load()), attr='body', ctx=Load()), attr='seek', ctx=Load()), args=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='pos', ctx=Load())], keywords=[]))], orelse=[]), Assign(targets=[Name(id='s_auth', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='r', ctx=Load()), attr='headers', ctx=Load()), attr='get', ctx=Load()), args=[Constant(value='www-authenticate'), Constant(value='')], keywords=[])), If(test=BoolOp(op=And(), values=[Compare(left=Constant(value='digest'), ops=[In()], comparators=[Call(func=Attribute(value=Name(id='s_auth', ctx=Load()), attr='lower', ctx=Load()), args=[], keywords=[])]), Compare(left=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='num_401_calls', ctx=Load()), ops=[Lt()], comparators=[Constant(value=2)])]), body=[AugAssign(target=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='num_401_calls', ctx=Store()), op=Add(), value=Constant(value=1)), Assign(targets=[Name(id='pat', ctx=Store())], value=Call(func=Attribute(value=Name(id='re', ctx=Load()), attr='compile', ctx=Load()), args=[Constant(value='digest ')], keywords=[keyword(arg='flags', value=Attribute(value=Name(id='re', ctx=Load()), attr='IGNORECASE', ctx=Load()))])), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='chal', ctx=Store())], value=Call(func=Name(id='parse_dict_header', ctx=Load()), args=[Call(func=Attribute(value=Name(id='pat', ctx=Load()), attr='sub', ctx=Load()), args=[Constant(value=''), Name(id='s_auth', ctx=Load())], keywords=[keyword(arg='count', value=Constant(value=1))])], keywords=[])), Expr(value=Attribute(value=Name(id='r', ctx=Load()), attr='content', ctx=Load())), Expr(value=Call(func=Attribute(value=Name(id='r', ctx=Load()), attr='close', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='prep', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='r', ctx=Load()), attr='request', ctx=Load()), attr='copy', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Name(id='extract_cookies_to_jar', ctx=Load()), args=[Attribute(value=Name(id='prep', ctx=Load()), attr='_cookies', ctx=Load()), Attribute(value=Name(id='r', ctx=Load()), attr='request', ctx=Load()), Attribute(value=Name(id='r', ctx=Load()), attr='raw', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='prep', ctx=Load()), attr='prepare_cookies', ctx=Load()), args=[Attribute(value=Name(id='prep', ctx=Load()), attr='_cookies', ctx=Load())], keywords=[])), Assign(targets=[Subscript(value=Attribute(value=Name(id='prep', ctx=Load()), attr='headers', ctx=Load()), slice=Constant(value='Authorization'), ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='build_digest_header', ctx=Load()), args=[Attribute(value=Name(id='prep', ctx=Load()), attr='method', ctx=Load()), Attribute(value=Name(id='prep', ctx=Load()), attr='url', ctx=Load())], keywords=[])), Assign(targets=[Name(id='_r', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='r', ctx=Load()), attr='connection', ctx=Load()), attr='send', ctx=Load()), args=[Name(id='prep', ctx=Load())], keywords=[keyword(value=Name(id='kwargs', ctx=Load()))])), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='_r', ctx=Load()), attr='history', ctx=Load()), attr='append', ctx=Load()), args=[Name(id='r', ctx=Load())], keywords=[])), Assign(targets=[Attribute(value=Name(id='_r', ctx=Load()), attr='request', ctx=Store())], value=Name(id='prep', ctx=Load())), Return(value=Name(id='_r', ctx=Load()))], orelse=[]), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='num_401_calls', ctx=Store())], value=Constant(value=1)), Return(value=Name(id='r', ctx=Load()))], decorator_list=[]), FunctionDef(name='__call__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='r')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='init_per_thread_state', ctx=Load()), args=[], keywords=[])), If(test=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='last_nonce', ctx=Load()), body=[Assign(targets=[Subscript(value=Attribute(value=Name(id='r', ctx=Load()), attr='headers', ctx=Load()), slice=Constant(value='Authorization'), ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='build_digest_header', ctx=Load()), args=[Attribute(value=Name(id='r', ctx=Load()), attr='method', ctx=Load()), Attribute(value=Name(id='r', ctx=Load()), attr='url', ctx=Load())], keywords=[]))], orelse=[]), Try(body=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='pos', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='r', ctx=Load()), attr='body', ctx=Load()), attr='tell', ctx=Load()), args=[], keywords=[]))], handlers=[ExceptHandler(type=Name(id='AttributeError', ctx=Load()), body=[Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='pos', ctx=Store())], value=Constant(value=None))])], orelse=[], finalbody=[]), Expr(value=Call(func=Attribute(value=Name(id='r', ctx=Load()), attr='register_hook', ctx=Load()), args=[Constant(value='response'), Attribute(value=Name(id='self', ctx=Load()), attr='handle_401', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='r', ctx=Load()), attr='register_hook', ctx=Load()), args=[Constant(value='response'), Attribute(value=Name(id='self', ctx=Load()), attr='handle_redirect', ctx=Load())], keywords=[])), Assign(targets=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_thread_local', ctx=Load()), attr='num_401_calls', ctx=Store())], value=Constant(value=1)), Return(value=Name(id='r', ctx=Load()))], decorator_list=[]), FunctionDef(name='__eq__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='other')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Name(id='all', ctx=Load()), args=[List(elts=[Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='username', ctx=Load()), ops=[Eq()], comparators=[Call(func=Name(id='getattr', ctx=Load()), args=[Name(id='other', ctx=Load()), Constant(value='username'), Constant(value=None)], keywords=[])]), Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='password', ctx=Load()), ops=[Eq()], comparators=[Call(func=Name(id='getattr', ctx=Load()), args=[Name(id='other', ctx=Load()), Constant(value='password'), Constant(value=None)], keywords=[])])], ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='__ne__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='other')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=UnaryOp(op=Not(), operand=Compare(left=Name(id='self', ctx=Load()), ops=[Eq()], comparators=[Name(id='other', ctx=Load())])))], decorator_list=[])], decorator_list=[])], type_ignores=[])