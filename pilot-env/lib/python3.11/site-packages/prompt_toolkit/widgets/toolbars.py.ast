Module(body=[ImportFrom(module='__future__', names=[alias(name='annotations')], level=0), ImportFrom(module='typing', names=[alias(name='Any')], level=0), ImportFrom(module='prompt_toolkit.application.current', names=[alias(name='get_app')], level=0), ImportFrom(module='prompt_toolkit.buffer', names=[alias(name='Buffer')], level=0), ImportFrom(module='prompt_toolkit.enums', names=[alias(name='SYSTEM_BUFFER')], level=0), ImportFrom(module='prompt_toolkit.filters', names=[alias(name='Condition'), alias(name='FilterOrBool'), alias(name='emacs_mode'), alias(name='has_arg'), alias(name='has_completions'), alias(name='has_focus'), alias(name='has_validation_error'), alias(name='to_filter'), alias(name='vi_mode'), alias(name='vi_navigation_mode')], level=0), ImportFrom(module='prompt_toolkit.formatted_text', names=[alias(name='AnyFormattedText'), alias(name='StyleAndTextTuples'), alias(name='fragment_list_len'), alias(name='to_formatted_text')], level=0), ImportFrom(module='prompt_toolkit.key_binding.key_bindings', names=[alias(name='ConditionalKeyBindings'), alias(name='KeyBindings'), alias(name='KeyBindingsBase'), alias(name='merge_key_bindings')], level=0), ImportFrom(module='prompt_toolkit.key_binding.key_processor', names=[alias(name='KeyPressEvent')], level=0), ImportFrom(module='prompt_toolkit.key_binding.vi_state', names=[alias(name='InputMode')], level=0), ImportFrom(module='prompt_toolkit.keys', names=[alias(name='Keys')], level=0), ImportFrom(module='prompt_toolkit.layout.containers', names=[alias(name='ConditionalContainer'), alias(name='Container'), alias(name='Window')], level=0), ImportFrom(module='prompt_toolkit.layout.controls', names=[alias(name='BufferControl'), alias(name='FormattedTextControl'), alias(name='SearchBufferControl'), alias(name='UIContent'), alias(name='UIControl')], level=0), ImportFrom(module='prompt_toolkit.layout.dimension', names=[alias(name='Dimension')], level=0), ImportFrom(module='prompt_toolkit.layout.processors', names=[alias(name='BeforeInput')], level=0), ImportFrom(module='prompt_toolkit.lexers', names=[alias(name='SimpleLexer')], level=0), ImportFrom(module='prompt_toolkit.search', names=[alias(name='SearchDirection')], level=0), Assign(targets=[Name(id='__all__', ctx=Store())], value=List(elts=[Constant(value='ArgToolbar'), Constant(value='CompletionsToolbar'), Constant(value='FormattedTextToolbar'), Constant(value='SearchToolbar'), Constant(value='SystemToolbar'), Constant(value='ValidationToolbar')], ctx=Load())), Assign(targets=[Name(id='E', ctx=Store())], value=Name(id='KeyPressEvent', ctx=Load())), ClassDef(name='FormattedTextToolbar', bases=[Name(id='Window', ctx=Load())], keywords=[], body=[FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='text', annotation=Name(id='AnyFormattedText', ctx=Load())), arg(arg='style', annotation=Name(id='str', ctx=Load()))], kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kw', annotation=Name(id='Any', ctx=Load())), defaults=[Constant(value='')]), body=[Expr(value=Call(func=Attribute(value=Call(func=Name(id='super', ctx=Load()), args=[], keywords=[]), attr='__init__', ctx=Load()), args=[Call(func=Name(id='FormattedTextControl', ctx=Load()), args=[Name(id='text', ctx=Load())], keywords=[keyword(value=Name(id='kw', ctx=Load()))])], keywords=[keyword(arg='style', value=Name(id='style', ctx=Load())), keyword(arg='dont_extend_height', value=Constant(value=True)), keyword(arg='height', value=Call(func=Name(id='Dimension', ctx=Load()), args=[], keywords=[keyword(arg='min', value=Constant(value=1))]))]))], decorator_list=[], returns=Constant(value=None))], decorator_list=[]), ClassDef(name='SystemToolbar', bases=[], keywords=[], body=[Expr(value=Constant(value='\n    Toolbar for a system prompt.\n\n    :param prompt: Prompt to be displayed to the user.\n    ')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='prompt', annotation=Name(id='AnyFormattedText', ctx=Load())), arg(arg='enable_global_bindings', annotation=Name(id='FilterOrBool', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='Shell command: '), Constant(value=True)]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='prompt', ctx=Store())], value=Name(id='prompt', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='enable_global_bindings', ctx=Store())], value=Call(func=Name(id='to_filter', ctx=Load()), args=[Name(id='enable_global_bindings', ctx=Load())], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Store())], value=Call(func=Name(id='Buffer', ctx=Load()), args=[], keywords=[keyword(arg='name', value=Name(id='SYSTEM_BUFFER', ctx=Load()))])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_bindings', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='_build_key_bindings', ctx=Load()), args=[], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='buffer_control', ctx=Store())], value=Call(func=Name(id='BufferControl', ctx=Load()), args=[], keywords=[keyword(arg='buffer', value=Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load())), keyword(arg='lexer', value=Call(func=Name(id='SimpleLexer', ctx=Load()), args=[], keywords=[keyword(arg='style', value=Constant(value='class:system-toolbar.text'))])), keyword(arg='input_processors', value=List(elts=[Call(func=Name(id='BeforeInput', ctx=Load()), args=[Lambda(args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=Attribute(value=Name(id='self', ctx=Load()), attr='prompt', ctx=Load()))], keywords=[keyword(arg='style', value=Constant(value='class:system-toolbar'))])], ctx=Load())), keyword(arg='key_bindings', value=Attribute(value=Name(id='self', ctx=Load()), attr='_bindings', ctx=Load()))])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='window', ctx=Store())], value=Call(func=Name(id='Window', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='buffer_control', ctx=Load())], keywords=[keyword(arg='height', value=Constant(value=1)), keyword(arg='style', value=Constant(value='class:system-toolbar'))])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Store())], value=Call(func=Name(id='ConditionalContainer', ctx=Load()), args=[], keywords=[keyword(arg='content', value=Attribute(value=Name(id='self', ctx=Load()), attr='window', ctx=Load())), keyword(arg='filter', value=Call(func=Name(id='has_focus', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load())], keywords=[]))]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='_get_display_before_text', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=List(elts=[Tuple(elts=[Constant(value='class:system-toolbar'), Constant(value='Shell command: ')], ctx=Load()), Tuple(elts=[Constant(value='class:system-toolbar.text'), Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load()), attr='text', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value=''), Constant(value='\n')], ctx=Load())], ctx=Load()))], decorator_list=[], returns=Name(id='StyleAndTextTuples', ctx=Load())), FunctionDef(name='_build_key_bindings', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='focused', ctx=Store())], value=Call(func=Name(id='has_focus', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load())], keywords=[])), Assign(targets=[Name(id='emacs_bindings', ctx=Store())], value=Call(func=Name(id='KeyBindings', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='handle', ctx=Store())], value=Attribute(value=Name(id='emacs_bindings', ctx=Load()), attr='add', ctx=Load())), FunctionDef(name='_cancel', args=arguments(posonlyargs=[], args=[arg(arg='event', annotation=Name(id='E', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Hide system prompt.')), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load()), attr='reset', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='layout', ctx=Load()), attr='focus_last', ctx=Load()), args=[], keywords=[]))], decorator_list=[Call(func=Name(id='handle', ctx=Load()), args=[Constant(value='escape')], keywords=[keyword(arg='filter', value=Name(id='focused', ctx=Load()))]), Call(func=Name(id='handle', ctx=Load()), args=[Constant(value='c-g')], keywords=[keyword(arg='filter', value=Name(id='focused', ctx=Load()))]), Call(func=Name(id='handle', ctx=Load()), args=[Constant(value='c-c')], keywords=[keyword(arg='filter', value=Name(id='focused', ctx=Load()))])], returns=Constant(value=None)), AsyncFunctionDef(name='_accept', args=arguments(posonlyargs=[], args=[arg(arg='event', annotation=Name(id='E', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Run system command.')), Expr(value=Await(value=Call(func=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='run_system_command', ctx=Load()), args=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load()), attr='text', ctx=Load())], keywords=[keyword(arg='display_before_text', value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='_get_display_before_text', ctx=Load()), args=[], keywords=[]))]))), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load()), attr='reset', ctx=Load()), args=[], keywords=[keyword(arg='append_to_history', value=Constant(value=True))])), Expr(value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='layout', ctx=Load()), attr='focus_last', ctx=Load()), args=[], keywords=[]))], decorator_list=[Call(func=Name(id='handle', ctx=Load()), args=[Constant(value='enter')], keywords=[keyword(arg='filter', value=Name(id='focused', ctx=Load()))])], returns=Constant(value=None)), Assign(targets=[Name(id='vi_bindings', ctx=Store())], value=Call(func=Name(id='KeyBindings', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='handle', ctx=Store())], value=Attribute(value=Name(id='vi_bindings', ctx=Load()), attr='add', ctx=Load())), FunctionDef(name='_cancel_vi', args=arguments(posonlyargs=[], args=[arg(arg='event', annotation=Name(id='E', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Hide system prompt.')), Assign(targets=[Attribute(value=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='vi_state', ctx=Load()), attr='input_mode', ctx=Store())], value=Attribute(value=Name(id='InputMode', ctx=Load()), attr='NAVIGATION', ctx=Load())), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load()), attr='reset', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='layout', ctx=Load()), attr='focus_last', ctx=Load()), args=[], keywords=[]))], decorator_list=[Call(func=Name(id='handle', ctx=Load()), args=[Constant(value='escape')], keywords=[keyword(arg='filter', value=Name(id='focused', ctx=Load()))]), Call(func=Name(id='handle', ctx=Load()), args=[Constant(value='c-c')], keywords=[keyword(arg='filter', value=Name(id='focused', ctx=Load()))])], returns=Constant(value=None)), AsyncFunctionDef(name='_accept_vi', args=arguments(posonlyargs=[], args=[arg(arg='event', annotation=Name(id='E', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Run system command.')), Assign(targets=[Attribute(value=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='vi_state', ctx=Load()), attr='input_mode', ctx=Store())], value=Attribute(value=Name(id='InputMode', ctx=Load()), attr='NAVIGATION', ctx=Load())), Expr(value=Await(value=Call(func=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='run_system_command', ctx=Load()), args=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load()), attr='text', ctx=Load())], keywords=[keyword(arg='display_before_text', value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='_get_display_before_text', ctx=Load()), args=[], keywords=[]))]))), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='system_buffer', ctx=Load()), attr='reset', ctx=Load()), args=[], keywords=[keyword(arg='append_to_history', value=Constant(value=True))])), Expr(value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='layout', ctx=Load()), attr='focus_last', ctx=Load()), args=[], keywords=[]))], decorator_list=[Call(func=Name(id='handle', ctx=Load()), args=[Constant(value='enter')], keywords=[keyword(arg='filter', value=Name(id='focused', ctx=Load()))])], returns=Constant(value=None)), Assign(targets=[Name(id='global_bindings', ctx=Store())], value=Call(func=Name(id='KeyBindings', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='handle', ctx=Store())], value=Attribute(value=Name(id='global_bindings', ctx=Load()), attr='add', ctx=Load())), FunctionDef(name='_focus_me', args=arguments(posonlyargs=[], args=[arg(arg='event', annotation=Name(id='E', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value="M-'!' will focus this user control.")), Expr(value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='layout', ctx=Load()), attr='focus', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='window', ctx=Load())], keywords=[]))], decorator_list=[Call(func=Name(id='handle', ctx=Load()), args=[Attribute(value=Name(id='Keys', ctx=Load()), attr='Escape', ctx=Load()), Constant(value='!')], keywords=[keyword(arg='filter', value=BinOp(left=UnaryOp(op=Invert(), operand=Name(id='focused', ctx=Load())), op=BitAnd(), right=Name(id='emacs_mode', ctx=Load()))), keyword(arg='is_global', value=Constant(value=True))])], returns=Constant(value=None)), FunctionDef(name='_focus_me_vi', args=arguments(posonlyargs=[], args=[arg(arg='event', annotation=Name(id='E', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Focus.')), Assign(targets=[Attribute(value=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='vi_state', ctx=Load()), attr='input_mode', ctx=Store())], value=Attribute(value=Name(id='InputMode', ctx=Load()), attr='INSERT', ctx=Load())), Expr(value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='event', ctx=Load()), attr='app', ctx=Load()), attr='layout', ctx=Load()), attr='focus', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='window', ctx=Load())], keywords=[]))], decorator_list=[Call(func=Name(id='handle', ctx=Load()), args=[Constant(value='!')], keywords=[keyword(arg='filter', value=BinOp(left=BinOp(left=UnaryOp(op=Invert(), operand=Name(id='focused', ctx=Load())), op=BitAnd(), right=Name(id='vi_mode', ctx=Load())), op=BitAnd(), right=Name(id='vi_navigation_mode', ctx=Load()))), keyword(arg='is_global', value=Constant(value=True))])], returns=Constant(value=None)), Return(value=Call(func=Name(id='merge_key_bindings', ctx=Load()), args=[List(elts=[Call(func=Name(id='ConditionalKeyBindings', ctx=Load()), args=[Name(id='emacs_bindings', ctx=Load()), Name(id='emacs_mode', ctx=Load())], keywords=[]), Call(func=Name(id='ConditionalKeyBindings', ctx=Load()), args=[Name(id='vi_bindings', ctx=Load()), Name(id='vi_mode', ctx=Load())], keywords=[]), Call(func=Name(id='ConditionalKeyBindings', ctx=Load()), args=[Name(id='global_bindings', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='enable_global_bindings', ctx=Load())], keywords=[])], ctx=Load())], keywords=[]))], decorator_list=[], returns=Name(id='KeyBindingsBase', ctx=Load())), FunctionDef(name='__pt_container__', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Load()))], decorator_list=[], returns=Name(id='Container', ctx=Load()))], decorator_list=[]), ClassDef(name='ArgToolbar', bases=[], keywords=[], body=[FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[FunctionDef(name='get_formatted_text', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='arg', ctx=Store())], value=BoolOp(op=Or(), values=[Attribute(value=Attribute(value=Call(func=Name(id='get_app', ctx=Load()), args=[], keywords=[]), attr='key_processor', ctx=Load()), attr='arg', ctx=Load()), Constant(value='')])), If(test=Compare(left=Name(id='arg', ctx=Load()), ops=[Eq()], comparators=[Constant(value='-')]), body=[Assign(targets=[Name(id='arg', ctx=Store())], value=Constant(value='-1'))], orelse=[]), Return(value=List(elts=[Tuple(elts=[Constant(value='class:arg-toolbar'), Constant(value='Repeat: ')], ctx=Load()), Tuple(elts=[Constant(value='class:arg-toolbar.text'), Name(id='arg', ctx=Load())], ctx=Load())], ctx=Load()))], decorator_list=[], returns=Name(id='StyleAndTextTuples', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='window', ctx=Store())], value=Call(func=Name(id='Window', ctx=Load()), args=[Call(func=Name(id='FormattedTextControl', ctx=Load()), args=[Name(id='get_formatted_text', ctx=Load())], keywords=[])], keywords=[keyword(arg='height', value=Constant(value=1))])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Store())], value=Call(func=Name(id='ConditionalContainer', ctx=Load()), args=[], keywords=[keyword(arg='content', value=Attribute(value=Name(id='self', ctx=Load()), attr='window', ctx=Load())), keyword(arg='filter', value=Name(id='has_arg', ctx=Load()))]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='__pt_container__', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Load()))], decorator_list=[], returns=Name(id='Container', ctx=Load()))], decorator_list=[]), ClassDef(name='SearchToolbar', bases=[], keywords=[], body=[Expr(value=Constant(value="\n    :param vi_mode: Display '/' and '?' instead of I-search.\n    :param ignore_case: Search case insensitive.\n    ")), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='search_buffer', annotation=BinOp(left=Name(id='Buffer', ctx=Load()), op=BitOr(), right=Constant(value=None))), arg(arg='vi_mode', annotation=Name(id='bool', ctx=Load())), arg(arg='text_if_not_searching', annotation=Name(id='AnyFormattedText', ctx=Load())), arg(arg='forward_search_prompt', annotation=Name(id='AnyFormattedText', ctx=Load())), arg(arg='backward_search_prompt', annotation=Name(id='AnyFormattedText', ctx=Load())), arg(arg='ignore_case', annotation=Name(id='FilterOrBool', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=None), Constant(value=False), Constant(value=''), Constant(value='I-search: '), Constant(value='I-search backward: '), Constant(value=False)]), body=[If(test=Compare(left=Name(id='search_buffer', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=[Assign(targets=[Name(id='search_buffer', ctx=Store())], value=Call(func=Name(id='Buffer', ctx=Load()), args=[], keywords=[]))], orelse=[]), FunctionDef(name='is_searching', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='control', ctx=Load()), ops=[In()], comparators=[Attribute(value=Attribute(value=Call(func=Name(id='get_app', ctx=Load()), args=[], keywords=[]), attr='layout', ctx=Load()), attr='search_links', ctx=Load())]))], decorator_list=[Name(id='Condition', ctx=Load())], returns=Name(id='bool', ctx=Load())), FunctionDef(name='get_before_input', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Name(id='is_searching', ctx=Load()), args=[], keywords=[])), body=[Return(value=Name(id='text_if_not_searching', ctx=Load()))], orelse=[If(test=Compare(left=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='control', ctx=Load()), attr='searcher_search_state', ctx=Load()), attr='direction', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Name(id='SearchDirection', ctx=Load()), attr='BACKWARD', ctx=Load())]), body=[Return(value=IfExp(test=Name(id='vi_mode', ctx=Load()), body=Constant(value='?'), orelse=Name(id='backward_search_prompt', ctx=Load())))], orelse=[Return(value=IfExp(test=Name(id='vi_mode', ctx=Load()), body=Constant(value='/'), orelse=Name(id='forward_search_prompt', ctx=Load())))])])], decorator_list=[], returns=Name(id='AnyFormattedText', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='search_buffer', ctx=Store())], value=Name(id='search_buffer', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='control', ctx=Store())], value=Call(func=Name(id='SearchBufferControl', ctx=Load()), args=[], keywords=[keyword(arg='buffer', value=Name(id='search_buffer', ctx=Load())), keyword(arg='input_processors', value=List(elts=[Call(func=Name(id='BeforeInput', ctx=Load()), args=[Name(id='get_before_input', ctx=Load())], keywords=[keyword(arg='style', value=Constant(value='class:search-toolbar.prompt'))])], ctx=Load())), keyword(arg='lexer', value=Call(func=Name(id='SimpleLexer', ctx=Load()), args=[], keywords=[keyword(arg='style', value=Constant(value='class:search-toolbar.text'))])), keyword(arg='ignore_case', value=Name(id='ignore_case', ctx=Load()))])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Store())], value=Call(func=Name(id='ConditionalContainer', ctx=Load()), args=[], keywords=[keyword(arg='content', value=Call(func=Name(id='Window', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='control', ctx=Load())], keywords=[keyword(arg='height', value=Constant(value=1)), keyword(arg='style', value=Constant(value='class:search-toolbar'))])), keyword(arg='filter', value=Name(id='is_searching', ctx=Load()))]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='__pt_container__', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Load()))], decorator_list=[], returns=Name(id='Container', ctx=Load()))], decorator_list=[]), ClassDef(name='_CompletionsToolbarControl', bases=[Name(id='UIControl', ctx=Load())], keywords=[], body=[FunctionDef(name='create_content', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='width', annotation=Name(id='int', ctx=Load())), arg(arg='height', annotation=Name(id='int', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[AnnAssign(target=Name(id='all_fragments', ctx=Store()), annotation=Name(id='StyleAndTextTuples', ctx=Load()), value=List(elts=[], ctx=Load()), simple=1), Assign(targets=[Name(id='complete_state', ctx=Store())], value=Attribute(value=Attribute(value=Call(func=Name(id='get_app', ctx=Load()), args=[], keywords=[]), attr='current_buffer', ctx=Load()), attr='complete_state', ctx=Load())), If(test=Name(id='complete_state', ctx=Load()), body=[Assign(targets=[Name(id='completions', ctx=Store())], value=Attribute(value=Name(id='complete_state', ctx=Load()), attr='completions', ctx=Load())), Assign(targets=[Name(id='index', ctx=Store())], value=Attribute(value=Name(id='complete_state', ctx=Load()), attr='complete_index', ctx=Load())), Assign(targets=[Name(id='content_width', ctx=Store())], value=BinOp(left=Name(id='width', ctx=Load()), op=Sub(), right=Constant(value=6))), Assign(targets=[Name(id='cut_left', ctx=Store())], value=Constant(value=False)), Assign(targets=[Name(id='cut_right', ctx=Store())], value=Constant(value=False)), AnnAssign(target=Name(id='fragments', ctx=Store()), annotation=Name(id='StyleAndTextTuples', ctx=Load()), value=List(elts=[], ctx=Load()), simple=1), For(target=Tuple(elts=[Name(id='i', ctx=Store()), Name(id='c', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='enumerate', ctx=Load()), args=[Name(id='completions', ctx=Load())], keywords=[]), body=[If(test=Compare(left=BinOp(left=Call(func=Name(id='fragment_list_len', ctx=Load()), args=[Name(id='fragments', ctx=Load())], keywords=[]), op=Add(), right=Call(func=Name(id='len', ctx=Load()), args=[Attribute(value=Name(id='c', ctx=Load()), attr='display_text', ctx=Load())], keywords=[])), ops=[GtE()], comparators=[Name(id='content_width', ctx=Load())]), body=[If(test=Compare(left=Name(id='i', ctx=Load()), ops=[LtE()], comparators=[BoolOp(op=Or(), values=[Name(id='index', ctx=Load()), Constant(value=0)])]), body=[Assign(targets=[Name(id='fragments', ctx=Store())], value=List(elts=[], ctx=Load())), Assign(targets=[Name(id='cut_left', ctx=Store())], value=Constant(value=True))], orelse=[Assign(targets=[Name(id='cut_right', ctx=Store())], value=Constant(value=True)), Break()])], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='fragments', ctx=Load()), attr='extend', ctx=Load()), args=[Call(func=Name(id='to_formatted_text', ctx=Load()), args=[Attribute(value=Name(id='c', ctx=Load()), attr='display_text', ctx=Load())], keywords=[keyword(arg='style', value=IfExp(test=Compare(left=Name(id='i', ctx=Load()), ops=[Eq()], comparators=[Name(id='index', ctx=Load())]), body=Constant(value='class:completion-toolbar.completion.current'), orelse=Constant(value='class:completion-toolbar.completion')))])], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='fragments', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Constant(value=''), Constant(value=' ')], ctx=Load())], keywords=[]))], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='fragments', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Constant(value=''), BinOp(left=Constant(value=' '), op=Mult(), right=BinOp(left=Name(id='content_width', ctx=Load()), op=Sub(), right=Call(func=Name(id='fragment_list_len', ctx=Load()), args=[Name(id='fragments', ctx=Load())], keywords=[])))], ctx=Load())], keywords=[])), Assign(targets=[Name(id='fragments', ctx=Store())], value=Subscript(value=Name(id='fragments', ctx=Load()), slice=Slice(upper=Name(id='content_width', ctx=Load())), ctx=Load())), Expr(value=Call(func=Attribute(value=Name(id='all_fragments', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Constant(value=''), Constant(value=' ')], ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='all_fragments', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Constant(value='class:completion-toolbar.arrow'), IfExp(test=Name(id='cut_left', ctx=Load()), body=Constant(value='<'), orelse=Constant(value=' '))], ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='all_fragments', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Constant(value=''), Constant(value=' ')], ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='all_fragments', ctx=Load()), attr='extend', ctx=Load()), args=[Name(id='fragments', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='all_fragments', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Constant(value=''), Constant(value=' ')], ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='all_fragments', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Constant(value='class:completion-toolbar.arrow'), IfExp(test=Name(id='cut_right', ctx=Load()), body=Constant(value='>'), orelse=Constant(value=' '))], ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='all_fragments', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Constant(value=''), Constant(value=' ')], ctx=Load())], keywords=[]))], orelse=[]), FunctionDef(name='get_line', args=arguments(posonlyargs=[], args=[arg(arg='i', annotation=Name(id='int', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Name(id='all_fragments', ctx=Load()))], decorator_list=[], returns=Name(id='StyleAndTextTuples', ctx=Load())), Return(value=Call(func=Name(id='UIContent', ctx=Load()), args=[], keywords=[keyword(arg='get_line', value=Name(id='get_line', ctx=Load())), keyword(arg='line_count', value=Constant(value=1))]))], decorator_list=[], returns=Name(id='UIContent', ctx=Load()))], decorator_list=[]), ClassDef(name='CompletionsToolbar', bases=[], keywords=[], body=[FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Store())], value=Call(func=Name(id='ConditionalContainer', ctx=Load()), args=[], keywords=[keyword(arg='content', value=Call(func=Name(id='Window', ctx=Load()), args=[Call(func=Name(id='_CompletionsToolbarControl', ctx=Load()), args=[], keywords=[])], keywords=[keyword(arg='height', value=Constant(value=1)), keyword(arg='style', value=Constant(value='class:completion-toolbar'))])), keyword(arg='filter', value=Name(id='has_completions', ctx=Load()))]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='__pt_container__', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Load()))], decorator_list=[], returns=Name(id='Container', ctx=Load()))], decorator_list=[]), ClassDef(name='ValidationToolbar', bases=[], keywords=[], body=[FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='show_position', annotation=Name(id='bool', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=False)]), body=[FunctionDef(name='get_formatted_text', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='buff', ctx=Store())], value=Attribute(value=Call(func=Name(id='get_app', ctx=Load()), args=[], keywords=[]), attr='current_buffer', ctx=Load())), If(test=Attribute(value=Name(id='buff', ctx=Load()), attr='validation_error', ctx=Load()), body=[Assign(targets=[Tuple(elts=[Name(id='row', ctx=Store()), Name(id='column', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='buff', ctx=Load()), attr='document', ctx=Load()), attr='translate_index_to_position', ctx=Load()), args=[Attribute(value=Attribute(value=Name(id='buff', ctx=Load()), attr='validation_error', ctx=Load()), attr='cursor_position', ctx=Load())], keywords=[])), If(test=Name(id='show_position', ctx=Load()), body=[Assign(targets=[Name(id='text', ctx=Store())], value=Call(func=Attribute(value=Constant(value='{} (line={} column={})'), attr='format', ctx=Load()), args=[Attribute(value=Attribute(value=Name(id='buff', ctx=Load()), attr='validation_error', ctx=Load()), attr='message', ctx=Load()), BinOp(left=Name(id='row', ctx=Load()), op=Add(), right=Constant(value=1)), BinOp(left=Name(id='column', ctx=Load()), op=Add(), right=Constant(value=1))], keywords=[]))], orelse=[Assign(targets=[Name(id='text', ctx=Store())], value=Attribute(value=Attribute(value=Name(id='buff', ctx=Load()), attr='validation_error', ctx=Load()), attr='message', ctx=Load()))]), Return(value=List(elts=[Tuple(elts=[Constant(value='class:validation-toolbar'), Name(id='text', ctx=Load())], ctx=Load())], ctx=Load()))], orelse=[Return(value=List(elts=[], ctx=Load()))])], decorator_list=[], returns=Name(id='StyleAndTextTuples', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='control', ctx=Store())], value=Call(func=Name(id='FormattedTextControl', ctx=Load()), args=[Name(id='get_formatted_text', ctx=Load())], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Store())], value=Call(func=Name(id='ConditionalContainer', ctx=Load()), args=[], keywords=[keyword(arg='content', value=Call(func=Name(id='Window', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='control', ctx=Load())], keywords=[keyword(arg='height', value=Constant(value=1))])), keyword(arg='filter', value=Name(id='has_validation_error', ctx=Load()))]))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='__pt_container__', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Name(id='self', ctx=Load()), attr='container', ctx=Load()))], decorator_list=[], returns=Name(id='Container', ctx=Load()))], decorator_list=[])], type_ignores=[])