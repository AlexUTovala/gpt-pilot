Module(body=[Expr(value=Constant(value='\nValidator for a regular language.\n')), ImportFrom(module='__future__', names=[alias(name='annotations')], level=0), ImportFrom(module='prompt_toolkit.document', names=[alias(name='Document')], level=0), ImportFrom(module='prompt_toolkit.validation', names=[alias(name='ValidationError'), alias(name='Validator')], level=0), ImportFrom(module='compiler', names=[alias(name='_CompiledGrammar')], level=1), Assign(targets=[Name(id='__all__', ctx=Store())], value=List(elts=[Constant(value='GrammarValidator')], ctx=Load())), ClassDef(name='GrammarValidator', bases=[Name(id='Validator', ctx=Load())], keywords=[], body=[Expr(value=Constant(value='\n    Validator which can be used for validation according to variables in\n    the grammar. Each variable can have its own validator.\n\n    :param compiled_grammar: `GrammarCompleter` instance.\n    :param validators: `dict` mapping variable names of the grammar to the\n                       `Validator` instances to be used for each variable.\n    ')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='compiled_grammar', annotation=Name(id='_CompiledGrammar', ctx=Load())), arg(arg='validators', annotation=Subscript(value=Name(id='dict', ctx=Load()), slice=Tuple(elts=[Name(id='str', ctx=Load()), Name(id='Validator', ctx=Load())], ctx=Load()), ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='compiled_grammar', ctx=Store())], value=Name(id='compiled_grammar', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='validators', ctx=Store())], value=Name(id='validators', ctx=Load()))], decorator_list=[], returns=Constant(value=None)), FunctionDef(name='validate', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='document', annotation=Name(id='Document', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='m', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='compiled_grammar', ctx=Load()), attr='match', ctx=Load()), args=[Attribute(value=Name(id='document', ctx=Load()), attr='text', ctx=Load())], keywords=[])), If(test=Name(id='m', ctx=Load()), body=[For(target=Name(id='v', ctx=Store()), iter=Call(func=Attribute(value=Name(id='m', ctx=Load()), attr='variables', ctx=Load()), args=[], keywords=[]), body=[Assign(targets=[Name(id='validator', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='validators', ctx=Load()), attr='get', ctx=Load()), args=[Attribute(value=Name(id='v', ctx=Load()), attr='varname', ctx=Load())], keywords=[])), If(test=Name(id='validator', ctx=Load()), body=[Assign(targets=[Name(id='unwrapped_text', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='compiled_grammar', ctx=Load()), attr='unescape', ctx=Load()), args=[Attribute(value=Name(id='v', ctx=Load()), attr='varname', ctx=Load()), Attribute(value=Name(id='v', ctx=Load()), attr='value', ctx=Load())], keywords=[])), Assign(targets=[Name(id='inner_document', ctx=Store())], value=Call(func=Name(id='Document', ctx=Load()), args=[Name(id='unwrapped_text', ctx=Load()), Call(func=Name(id='len', ctx=Load()), args=[Name(id='unwrapped_text', ctx=Load())], keywords=[])], keywords=[])), Try(body=[Expr(value=Call(func=Attribute(value=Name(id='validator', ctx=Load()), attr='validate', ctx=Load()), args=[Name(id='inner_document', ctx=Load())], keywords=[]))], handlers=[ExceptHandler(type=Name(id='ValidationError', ctx=Load()), name='e', body=[Raise(exc=Call(func=Name(id='ValidationError', ctx=Load()), args=[], keywords=[keyword(arg='cursor_position', value=BinOp(left=Attribute(value=Name(id='v', ctx=Load()), attr='start', ctx=Load()), op=Add(), right=Attribute(value=Name(id='e', ctx=Load()), attr='cursor_position', ctx=Load()))), keyword(arg='message', value=Attribute(value=Name(id='e', ctx=Load()), attr='message', ctx=Load()))]), cause=Name(id='e', ctx=Load()))])], orelse=[], finalbody=[])], orelse=[])], orelse=[])], orelse=[Raise(exc=Call(func=Name(id='ValidationError', ctx=Load()), args=[], keywords=[keyword(arg='cursor_position', value=Call(func=Name(id='len', ctx=Load()), args=[Attribute(value=Name(id='document', ctx=Load()), attr='text', ctx=Load())], keywords=[])), keyword(arg='message', value=Constant(value='Invalid command'))]))])], decorator_list=[], returns=Constant(value=None))], decorator_list=[])], type_ignores=[])