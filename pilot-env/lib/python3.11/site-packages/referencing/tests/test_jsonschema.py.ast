Module(body=[Import(names=[alias(name='pytest')]), ImportFrom(module='referencing', names=[alias(name='Registry'), alias(name='Resource'), alias(name='Specification')], level=0), Import(names=[alias(name='referencing.jsonschema')]), FunctionDef(name='test_schemas_with_explicit_schema_keywords_are_detected', args=arguments(posonlyargs=[], args=[arg(arg='uri'), arg(arg='expected')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='\n    The $schema keyword in JSON Schema is a dialect identifier.\n    ')), Assign(targets=[Name(id='contents', ctx=Store())], value=Dict(keys=[Constant(value='$schema')], values=[Name(id='uri', ctx=Load())])), Assign(targets=[Name(id='resource', ctx=Store())], value=Call(func=Attribute(value=Name(id='Resource', ctx=Load()), attr='from_contents', ctx=Load()), args=[Name(id='contents', ctx=Load())], keywords=[])), Assert(test=Compare(left=Name(id='resource', ctx=Load()), ops=[Eq()], comparators=[Call(func=Name(id='Resource', ctx=Load()), args=[], keywords=[keyword(arg='contents', value=Name(id='contents', ctx=Load())), keyword(arg='specification', value=Name(id='expected', ctx=Load()))])]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='uri, expected'), List(elts=[Tuple(elts=[Constant(value='https://json-schema.org/draft/2020-12/schema'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='https://json-schema.org/draft/2019-09/schema'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-07/schema#'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT7', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-06/schema#'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT6', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-04/schema#'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT4', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-03/schema#'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT3', ctx=Load())], ctx=Load())], ctx=Load())], keywords=[])]), FunctionDef(name='test_unknown_dialect', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='dialect_id', ctx=Store())], value=Constant(value='http://example.com/unknown-json-schema-dialect-id')), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='pytest', ctx=Load()), attr='raises', ctx=Load()), args=[Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='UnknownDialect', ctx=Load())], keywords=[]), optional_vars=Name(id='excinfo', ctx=Store()))], body=[Expr(value=Call(func=Attribute(value=Name(id='Resource', ctx=Load()), attr='from_contents', ctx=Load()), args=[Dict(keys=[Constant(value='$schema')], values=[Name(id='dialect_id', ctx=Load())])], keywords=[]))]), Assert(test=Compare(left=Attribute(value=Attribute(value=Name(id='excinfo', ctx=Load()), attr='value', ctx=Load()), attr='uri', ctx=Load()), ops=[Eq()], comparators=[Name(id='dialect_id', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_id_of_mapping', args=arguments(posonlyargs=[], args=[arg(arg='id'), arg(arg='specification')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='uri', ctx=Store())], value=Constant(value='http://example.com/some-schema')), Assert(test=Compare(left=Call(func=Attribute(value=Name(id='specification', ctx=Load()), attr='id_of', ctx=Load()), args=[Dict(keys=[Name(id='id', ctx=Load())], values=[Name(id='uri', ctx=Load())])], keywords=[]), ops=[Eq()], comparators=[Name(id='uri', ctx=Load())]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='id, specification'), List(elts=[Tuple(elts=[Constant(value='$id'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='$id'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='$id'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT7', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='$id'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT6', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='id'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT4', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='id'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT3', ctx=Load())], ctx=Load())], ctx=Load())], keywords=[])]), FunctionDef(name='test_id_of_bool', args=arguments(posonlyargs=[], args=[arg(arg='specification'), arg(arg='value')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assert(test=Compare(left=Call(func=Attribute(value=Name(id='specification', ctx=Load()), attr='id_of', ctx=Load()), args=[Name(id='value', ctx=Load())], keywords=[]), ops=[Is()], comparators=[Constant(value=None)]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='specification'), List(elts=[Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load()), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT7', ctx=Load()), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT6', ctx=Load())], ctx=Load())], keywords=[]), Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='value'), List(elts=[Constant(value=True), Constant(value=False)], ctx=Load())], keywords=[])]), FunctionDef(name='test_anchors_in_bool', args=arguments(posonlyargs=[], args=[arg(arg='specification'), arg(arg='value')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assert(test=Compare(left=Call(func=Name(id='list', ctx=Load()), args=[Call(func=Attribute(value=Name(id='specification', ctx=Load()), attr='anchors_in', ctx=Load()), args=[Name(id='value', ctx=Load())], keywords=[])], keywords=[]), ops=[Eq()], comparators=[List(elts=[], ctx=Load())]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='specification'), List(elts=[Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load()), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT7', ctx=Load()), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT6', ctx=Load())], ctx=Load())], keywords=[]), Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='value'), List(elts=[Constant(value=True), Constant(value=False)], ctx=Load())], keywords=[])]), FunctionDef(name='test_subresources_of_bool', args=arguments(posonlyargs=[], args=[arg(arg='specification'), arg(arg='value')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assert(test=Compare(left=Call(func=Name(id='list', ctx=Load()), args=[Call(func=Attribute(value=Name(id='specification', ctx=Load()), attr='subresources_of', ctx=Load()), args=[Name(id='value', ctx=Load())], keywords=[])], keywords=[]), ops=[Eq()], comparators=[List(elts=[], ctx=Load())]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='specification'), List(elts=[Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load()), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT7', ctx=Load()), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT6', ctx=Load())], ctx=Load())], keywords=[]), Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='value'), List(elts=[Constant(value=True), Constant(value=False)], ctx=Load())], keywords=[])]), FunctionDef(name='test_specification_with', args=arguments(posonlyargs=[], args=[arg(arg='uri'), arg(arg='expected')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assert(test=Compare(left=Call(func=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='specification_with', ctx=Load()), args=[Name(id='uri', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Name(id='expected', ctx=Load())]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='uri, expected'), List(elts=[Tuple(elts=[Constant(value='https://json-schema.org/draft/2020-12/schema'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='https://json-schema.org/draft/2019-09/schema'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-07/schema#'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT7', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-06/schema#'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT6', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-04/schema#'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT4', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-03/schema#'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT3', ctx=Load())], ctx=Load())], ctx=Load())], keywords=[])]), FunctionDef(name='test_specification_with_no_empty_fragment', args=arguments(posonlyargs=[], args=[arg(arg='uri'), arg(arg='expected')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assert(test=Compare(left=Call(func=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='specification_with', ctx=Load()), args=[Name(id='uri', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Name(id='expected', ctx=Load())]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='uri, expected'), List(elts=[Tuple(elts=[Constant(value='http://json-schema.org/draft-07/schema'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT7', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-06/schema'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT6', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-04/schema'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT4', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://json-schema.org/draft-03/schema'), Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT3', ctx=Load())], ctx=Load())], ctx=Load())], keywords=[])]), FunctionDef(name='test_specification_with_unknown_dialect', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='dialect_id', ctx=Store())], value=Constant(value='http://example.com/unknown-json-schema-dialect-id')), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='pytest', ctx=Load()), attr='raises', ctx=Load()), args=[Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='UnknownDialect', ctx=Load())], keywords=[]), optional_vars=Name(id='excinfo', ctx=Store()))], body=[Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='specification_with', ctx=Load()), args=[Name(id='dialect_id', ctx=Load())], keywords=[]))]), Assert(test=Compare(left=Attribute(value=Attribute(value=Name(id='excinfo', ctx=Load()), attr='value', ctx=Load()), attr='uri', ctx=Load()), ops=[Eq()], comparators=[Name(id='dialect_id', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_specification_with_default', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='dialect_id', ctx=Store())], value=Constant(value='http://example.com/unknown-json-schema-dialect-id')), Assign(targets=[Name(id='specification', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='specification_with', ctx=Load()), args=[Name(id='dialect_id', ctx=Load())], keywords=[keyword(arg='default', value=Attribute(value=Name(id='Specification', ctx=Load()), attr='OPAQUE', ctx=Load()))])), Assert(test=Compare(left=Name(id='specification', ctx=Load()), ops=[Is()], comparators=[Attribute(value=Name(id='Specification', ctx=Load()), attr='OPAQUE', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_lookup_trivial_dynamic_ref', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='one', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load()), attr='create_resource', ctx=Load()), args=[Dict(keys=[Constant(value='$dynamicAnchor')], values=[Constant(value='foo')])], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Name(id='Registry', ctx=Load()), args=[], keywords=[]), attr='with_resource', ctx=Load()), args=[Constant(value='http://example.com'), Name(id='one', ctx=Load())], keywords=[]), attr='resolver', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='resolved', ctx=Store())], value=Call(func=Attribute(value=Name(id='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='http://example.com#foo')], keywords=[])), Assert(test=Compare(left=Attribute(value=Name(id='resolved', ctx=Load()), attr='contents', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Name(id='one', ctx=Load()), attr='contents', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_multiple_lookup_trivial_dynamic_ref', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='TRUE', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load()), attr='create_resource', ctx=Load()), args=[Constant(value=True)], keywords=[])), Assign(targets=[Name(id='root', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load()), attr='create_resource', ctx=Load()), args=[Dict(keys=[Constant(value='$id'), Constant(value='$dynamicAnchor'), Constant(value='$defs')], values=[Constant(value='http://example.com'), Constant(value='fooAnchor'), Dict(keys=[Constant(value='foo')], values=[Dict(keys=[Constant(value='$id'), Constant(value='$dynamicAnchor'), Constant(value='$defs')], values=[Constant(value='foo'), Constant(value='fooAnchor'), Dict(keys=[Constant(value='bar'), Constant(value='baz')], values=[Constant(value=True), Dict(keys=[Constant(value='$dynamicAnchor')], values=[Constant(value='fooAnchor')])])])])])], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Name(id='Registry', ctx=Load()), args=[], keywords=[]), attr='with_resources', ctx=Load()), args=[List(elts=[Tuple(elts=[Constant(value='http://example.com'), Name(id='root', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://example.com/foo/'), Name(id='TRUE', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://example.com/foo/bar'), Name(id='root', ctx=Load())], ctx=Load())], ctx=Load())], keywords=[]), attr='resolver', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='first', ctx=Store())], value=Call(func=Attribute(value=Name(id='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='http://example.com')], keywords=[])), Assign(targets=[Name(id='second', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='first', ctx=Load()), attr='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='foo/')], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='second', ctx=Load()), attr='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='bar')], keywords=[]), attr='resolver', ctx=Load())), Assign(targets=[Name(id='fourth', ctx=Store())], value=Call(func=Attribute(value=Name(id='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='#fooAnchor')], keywords=[])), Assert(test=Compare(left=Attribute(value=Name(id='fourth', ctx=Load()), attr='contents', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Name(id='root', ctx=Load()), attr='contents', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_multiple_lookup_dynamic_ref_to_nondynamic_ref', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='one', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load()), attr='create_resource', ctx=Load()), args=[Dict(keys=[Constant(value='$anchor')], values=[Constant(value='fooAnchor')])], keywords=[])), Assign(targets=[Name(id='two', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT202012', ctx=Load()), attr='create_resource', ctx=Load()), args=[Dict(keys=[Constant(value='$id'), Constant(value='$dynamicAnchor'), Constant(value='$defs')], values=[Constant(value='http://example.com'), Constant(value='fooAnchor'), Dict(keys=[Constant(value='foo')], values=[Dict(keys=[Constant(value='$id'), Constant(value='$dynamicAnchor'), Constant(value='$defs')], values=[Constant(value='foo'), Constant(value='fooAnchor'), Dict(keys=[Constant(value='bar'), Constant(value='baz')], values=[Constant(value=True), Dict(keys=[Constant(value='$dynamicAnchor')], values=[Constant(value='fooAnchor')])])])])])], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Name(id='Registry', ctx=Load()), args=[], keywords=[]), attr='with_resources', ctx=Load()), args=[List(elts=[Tuple(elts=[Constant(value='http://example.com'), Name(id='two', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://example.com/foo/'), Name(id='one', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://example.com/foo/bar'), Name(id='two', ctx=Load())], ctx=Load())], ctx=Load())], keywords=[]), attr='resolver', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='first', ctx=Store())], value=Call(func=Attribute(value=Name(id='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='http://example.com')], keywords=[])), Assign(targets=[Name(id='second', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='first', ctx=Load()), attr='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='foo/')], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='second', ctx=Load()), attr='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='bar')], keywords=[]), attr='resolver', ctx=Load())), Assign(targets=[Name(id='fourth', ctx=Store())], value=Call(func=Attribute(value=Name(id='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='#fooAnchor')], keywords=[])), Assert(test=Compare(left=Attribute(value=Name(id='fourth', ctx=Load()), attr='contents', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Name(id='two', ctx=Load()), attr='contents', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_lookup_trivial_recursive_ref', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='one', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), attr='create_resource', ctx=Load()), args=[Dict(keys=[Constant(value='$recursiveAnchor')], values=[Constant(value=True)])], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Name(id='Registry', ctx=Load()), args=[], keywords=[]), attr='with_resource', ctx=Load()), args=[Constant(value='http://example.com'), Name(id='one', ctx=Load())], keywords=[]), attr='resolver', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='first', ctx=Store())], value=Call(func=Attribute(value=Name(id='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='http://example.com')], keywords=[])), Assign(targets=[Name(id='resolved', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='lookup_recursive_ref', ctx=Load()), args=[], keywords=[keyword(arg='resolver', value=Attribute(value=Name(id='first', ctx=Load()), attr='resolver', ctx=Load()))])), Assert(test=Compare(left=Attribute(value=Name(id='resolved', ctx=Load()), attr='contents', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Name(id='one', ctx=Load()), attr='contents', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_lookup_recursive_ref_to_bool', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='TRUE', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), attr='create_resource', ctx=Load()), args=[Constant(value=True)], keywords=[])), Assign(targets=[Name(id='registry', ctx=Store())], value=Call(func=Name(id='Registry', ctx=Load()), args=[Dict(keys=[Constant(value='http://example.com')], values=[Name(id='TRUE', ctx=Load())])], keywords=[])), Assign(targets=[Name(id='resolved', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='lookup_recursive_ref', ctx=Load()), args=[], keywords=[keyword(arg='resolver', value=Call(func=Attribute(value=Name(id='registry', ctx=Load()), attr='resolver', ctx=Load()), args=[], keywords=[keyword(arg='base_uri', value=Constant(value='http://example.com'))]))])), Assert(test=Compare(left=Attribute(value=Name(id='resolved', ctx=Load()), attr='contents', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Name(id='TRUE', ctx=Load()), attr='contents', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_multiple_lookup_recursive_ref_to_bool', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='TRUE', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), attr='create_resource', ctx=Load()), args=[Constant(value=True)], keywords=[])), Assign(targets=[Name(id='root', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), attr='create_resource', ctx=Load()), args=[Dict(keys=[Constant(value='$id'), Constant(value='$recursiveAnchor'), Constant(value='$defs')], values=[Constant(value='http://example.com'), Constant(value=True), Dict(keys=[Constant(value='foo')], values=[Dict(keys=[Constant(value='$id'), Constant(value='$recursiveAnchor'), Constant(value='$defs')], values=[Constant(value='foo'), Constant(value=True), Dict(keys=[Constant(value='bar'), Constant(value='baz')], values=[Constant(value=True), Dict(keys=[Constant(value='$recursiveAnchor'), Constant(value='$anchor')], values=[Constant(value=True), Constant(value='fooAnchor')])])])])])], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Name(id='Registry', ctx=Load()), args=[], keywords=[]), attr='with_resources', ctx=Load()), args=[List(elts=[Tuple(elts=[Constant(value='http://example.com'), Name(id='root', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://example.com/foo/'), Name(id='TRUE', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://example.com/foo/bar'), Name(id='root', ctx=Load())], ctx=Load())], ctx=Load())], keywords=[]), attr='resolver', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='first', ctx=Store())], value=Call(func=Attribute(value=Name(id='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='http://example.com')], keywords=[])), Assign(targets=[Name(id='second', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='first', ctx=Load()), attr='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='foo/')], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='second', ctx=Load()), attr='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='bar')], keywords=[]), attr='resolver', ctx=Load())), Assign(targets=[Name(id='fourth', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='lookup_recursive_ref', ctx=Load()), args=[], keywords=[keyword(arg='resolver', value=Name(id='resolver', ctx=Load()))])), Assert(test=Compare(left=Attribute(value=Name(id='fourth', ctx=Load()), attr='contents', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Name(id='root', ctx=Load()), attr='contents', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_multiple_lookup_recursive_ref_with_nonrecursive_ref', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='one', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), attr='create_resource', ctx=Load()), args=[Dict(keys=[Constant(value='$recursiveAnchor')], values=[Constant(value=True)])], keywords=[])), Assign(targets=[Name(id='two', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), attr='create_resource', ctx=Load()), args=[Dict(keys=[Constant(value='$id'), Constant(value='$recursiveAnchor'), Constant(value='$defs')], values=[Constant(value='http://example.com'), Constant(value=True), Dict(keys=[Constant(value='foo')], values=[Dict(keys=[Constant(value='$id'), Constant(value='$recursiveAnchor'), Constant(value='$defs')], values=[Constant(value='foo'), Constant(value=True), Dict(keys=[Constant(value='bar'), Constant(value='baz')], values=[Constant(value=True), Dict(keys=[Constant(value='$recursiveAnchor'), Constant(value='$anchor')], values=[Constant(value=True), Constant(value='fooAnchor')])])])])])], keywords=[])), Assign(targets=[Name(id='three', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='DRAFT201909', ctx=Load()), attr='create_resource', ctx=Load()), args=[Dict(keys=[Constant(value='$recursiveAnchor')], values=[Constant(value=False)])], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Name(id='Registry', ctx=Load()), args=[], keywords=[]), attr='with_resources', ctx=Load()), args=[List(elts=[Tuple(elts=[Constant(value='http://example.com'), Name(id='three', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://example.com/foo/'), Name(id='two', ctx=Load())], ctx=Load()), Tuple(elts=[Constant(value='http://example.com/foo/bar'), Name(id='one', ctx=Load())], ctx=Load())], ctx=Load())], keywords=[]), attr='resolver', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='first', ctx=Store())], value=Call(func=Attribute(value=Name(id='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='http://example.com')], keywords=[])), Assign(targets=[Name(id='second', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='first', ctx=Load()), attr='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='foo/')], keywords=[])), Assign(targets=[Name(id='resolver', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='second', ctx=Load()), attr='resolver', ctx=Load()), attr='lookup', ctx=Load()), args=[Constant(value='bar')], keywords=[]), attr='resolver', ctx=Load())), Assign(targets=[Name(id='fourth', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='lookup_recursive_ref', ctx=Load()), args=[], keywords=[keyword(arg='resolver', value=Name(id='resolver', ctx=Load()))])), Assert(test=Compare(left=Attribute(value=Name(id='fourth', ctx=Load()), attr='contents', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Name(id='two', ctx=Load()), attr='contents', ctx=Load())]))], decorator_list=[]), FunctionDef(name='test_empty_registry', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assert(test=Compare(left=Attribute(value=Attribute(value=Name(id='referencing', ctx=Load()), attr='jsonschema', ctx=Load()), attr='EMPTY_REGISTRY', ctx=Load()), ops=[Eq()], comparators=[Call(func=Name(id='Registry', ctx=Load()), args=[], keywords=[])]))], decorator_list=[])], type_ignores=[])