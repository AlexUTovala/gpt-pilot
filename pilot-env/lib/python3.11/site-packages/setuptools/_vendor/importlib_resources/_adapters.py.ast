Module(body=[ImportFrom(module='contextlib', names=[alias(name='suppress')], level=0), ImportFrom(module='io', names=[alias(name='TextIOWrapper')], level=0), ImportFrom(names=[alias(name='abc')], level=1), ClassDef(name='SpecLoaderAdapter', bases=[], keywords=[], body=[Expr(value=Constant(value='\n    Adapt a package spec to adapt the underlying loader.\n    ')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='spec'), arg(arg='adapter')], kwonlyargs=[], kw_defaults=[], defaults=[Lambda(args=arguments(posonlyargs=[], args=[arg(arg='spec')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=Attribute(value=Name(id='spec', ctx=Load()), attr='loader', ctx=Load()))]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='spec', ctx=Store())], value=Name(id='spec', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='loader', ctx=Store())], value=Call(func=Name(id='adapter', ctx=Load()), args=[Name(id='spec', ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='__getattr__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='name')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Name(id='getattr', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='spec', ctx=Load()), Name(id='name', ctx=Load())], keywords=[]))], decorator_list=[])], decorator_list=[]), ClassDef(name='TraversableResourcesLoader', bases=[], keywords=[], body=[Expr(value=Constant(value='\n    Adapt a loader to provide TraversableResources.\n    ')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='spec')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='spec', ctx=Store())], value=Name(id='spec', ctx=Load()))], decorator_list=[]), FunctionDef(name='get_resource_reader', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='name')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Call(func=Name(id='CompatibilityFiles', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='spec', ctx=Load())], keywords=[]), attr='_native', ctx=Load()), args=[], keywords=[]))], decorator_list=[])], decorator_list=[]), FunctionDef(name='_io_wrapper', args=arguments(posonlyargs=[], args=[arg(arg='file'), arg(arg='mode')], vararg=arg(arg='args'), kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[Constant(value='r')]), body=[If(test=Compare(left=Name(id='mode', ctx=Load()), ops=[Eq()], comparators=[Constant(value='r')]), body=[Return(value=Call(func=Name(id='TextIOWrapper', ctx=Load()), args=[Name(id='file', ctx=Load()), Starred(value=Name(id='args', ctx=Load()), ctx=Load())], keywords=[keyword(value=Name(id='kwargs', ctx=Load()))]))], orelse=[If(test=Compare(left=Name(id='mode', ctx=Load()), ops=[Eq()], comparators=[Constant(value='rb')]), body=[Return(value=Name(id='file', ctx=Load()))], orelse=[])]), Raise(exc=Call(func=Name(id='ValueError', ctx=Load()), args=[Call(func=Attribute(value=Constant(value="Invalid mode value '{}', only 'r' and 'rb' are supported"), attr='format', ctx=Load()), args=[Name(id='mode', ctx=Load())], keywords=[])], keywords=[]))], decorator_list=[]), ClassDef(name='CompatibilityFiles', bases=[], keywords=[], body=[Expr(value=Constant(value='\n    Adapter for an existing or non-existent resource reader\n    to provide a compatibility .files().\n    ')), ClassDef(name='SpecPath', bases=[Attribute(value=Name(id='abc', ctx=Load()), attr='Traversable', ctx=Load())], keywords=[], body=[Expr(value=Constant(value='\n        Path tied to a module spec.\n        Can be read and exposes the resource reader children.\n        ')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='spec'), arg(arg='reader')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_spec', ctx=Store())], value=Name(id='spec', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Store())], value=Name(id='reader', ctx=Load()))], decorator_list=[]), FunctionDef(name='iterdir', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load())), body=[Return(value=Call(func=Name(id='iter', ctx=Load()), args=[Tuple(elts=[], ctx=Load())], keywords=[]))], orelse=[]), Return(value=Call(func=Name(id='iter', ctx=Load()), args=[GeneratorExp(elt=Call(func=Attribute(value=Name(id='CompatibilityFiles', ctx=Load()), attr='ChildPath', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load()), Name(id='path', ctx=Load())], keywords=[]), generators=[comprehension(target=Name(id='path', ctx=Store()), iter=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load()), attr='contents', ctx=Load()), args=[], keywords=[]), ifs=[], is_async=0)])], keywords=[]))], decorator_list=[]), FunctionDef(name='is_file', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Constant(value=False))], decorator_list=[]), Assign(targets=[Name(id='is_dir', ctx=Store())], value=Name(id='is_file', ctx=Load())), FunctionDef(name='joinpath', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='other')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load())), body=[Return(value=Call(func=Attribute(value=Name(id='CompatibilityFiles', ctx=Load()), attr='OrphanPath', ctx=Load()), args=[Name(id='other', ctx=Load())], keywords=[]))], orelse=[]), Return(value=Call(func=Attribute(value=Name(id='CompatibilityFiles', ctx=Load()), attr='ChildPath', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load()), Name(id='other', ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='name', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_spec', ctx=Load()), attr='name', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())]), FunctionDef(name='open', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='mode')], vararg=arg(arg='args'), kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[Constant(value='r')]), body=[Return(value=Call(func=Name(id='_io_wrapper', ctx=Load()), args=[Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load()), attr='open_resource', ctx=Load()), args=[Constant(value=None)], keywords=[]), Name(id='mode', ctx=Load()), Starred(value=Name(id='args', ctx=Load()), ctx=Load())], keywords=[keyword(value=Name(id='kwargs', ctx=Load()))]))], decorator_list=[])], decorator_list=[]), ClassDef(name='ChildPath', bases=[Attribute(value=Name(id='abc', ctx=Load()), attr='Traversable', ctx=Load())], keywords=[], body=[Expr(value=Constant(value="\n        Path tied to a resource reader child.\n        Can be read but doesn't expose any meaningful children.\n        ")), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='reader'), arg(arg='name')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Store())], value=Name(id='reader', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_name', ctx=Store())], value=Name(id='name', ctx=Load()))], decorator_list=[]), FunctionDef(name='iterdir', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Name(id='iter', ctx=Load()), args=[Tuple(elts=[], ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='is_file', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load()), attr='is_resource', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='name', ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='is_dir', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='is_file', ctx=Load()), args=[], keywords=[])))], decorator_list=[]), FunctionDef(name='joinpath', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='other')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Name(id='CompatibilityFiles', ctx=Load()), attr='OrphanPath', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='name', ctx=Load()), Name(id='other', ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='name', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Attribute(value=Name(id='self', ctx=Load()), attr='_name', ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())]), FunctionDef(name='open', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='mode')], vararg=arg(arg='args'), kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[Constant(value='r')]), body=[Return(value=Call(func=Name(id='_io_wrapper', ctx=Load()), args=[Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load()), attr='open_resource', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='name', ctx=Load())], keywords=[]), Name(id='mode', ctx=Load()), Starred(value=Name(id='args', ctx=Load()), ctx=Load())], keywords=[keyword(value=Name(id='kwargs', ctx=Load()))]))], decorator_list=[])], decorator_list=[]), ClassDef(name='OrphanPath', bases=[Attribute(value=Name(id='abc', ctx=Load()), attr='Traversable', ctx=Load())], keywords=[], body=[Expr(value=Constant(value="\n        Orphan path, not tied to a module spec or resource reader.\n        Can't be read and doesn't expose any meaningful children.\n        ")), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self')], vararg=arg(arg='path_parts'), kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='path_parts', ctx=Load())], keywords=[]), ops=[Lt()], comparators=[Constant(value=1)]), body=[Raise(exc=Call(func=Name(id='ValueError', ctx=Load()), args=[Constant(value='Need at least one path part to construct a path')], keywords=[]))], orelse=[]), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_path', ctx=Store())], value=Name(id='path_parts', ctx=Load()))], decorator_list=[]), FunctionDef(name='iterdir', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Name(id='iter', ctx=Load()), args=[Tuple(elts=[], ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='is_file', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Constant(value=False))], decorator_list=[]), Assign(targets=[Name(id='is_dir', ctx=Store())], value=Name(id='is_file', ctx=Load())), FunctionDef(name='joinpath', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='other')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Name(id='CompatibilityFiles', ctx=Load()), attr='OrphanPath', ctx=Load()), args=[Starred(value=Attribute(value=Name(id='self', ctx=Load()), attr='_path', ctx=Load()), ctx=Load()), Name(id='other', ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='name', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Subscript(value=Attribute(value=Name(id='self', ctx=Load()), attr='_path', ctx=Load()), slice=UnaryOp(op=USub(), operand=Constant(value=1)), ctx=Load()))], decorator_list=[Name(id='property', ctx=Load())]), FunctionDef(name='open', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='mode')], vararg=arg(arg='args'), kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[Constant(value='r')]), body=[Raise(exc=Call(func=Name(id='FileNotFoundError', ctx=Load()), args=[Constant(value="Can't open orphan path")], keywords=[]))], decorator_list=[])], decorator_list=[]), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='spec')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='spec', ctx=Store())], value=Name(id='spec', ctx=Load()))], decorator_list=[]), FunctionDef(name='_reader', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[With(items=[withitem(context_expr=Call(func=Name(id='suppress', ctx=Load()), args=[Name(id='AttributeError', ctx=Load())], keywords=[]))], body=[Return(value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='spec', ctx=Load()), attr='loader', ctx=Load()), attr='get_resource_reader', ctx=Load()), args=[Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='spec', ctx=Load()), attr='name', ctx=Load())], keywords=[]))])], decorator_list=[Name(id='property', ctx=Load())]), FunctionDef(name='_native', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='\n        Return the native reader if it supports files().\n        ')), Assign(targets=[Name(id='reader', ctx=Store())], value=Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load())), Return(value=IfExp(test=Call(func=Name(id='hasattr', ctx=Load()), args=[Name(id='reader', ctx=Load()), Constant(value='files')], keywords=[]), body=Name(id='reader', ctx=Load()), orelse=Name(id='self', ctx=Load())))], decorator_list=[]), FunctionDef(name='__getattr__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='attr')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Name(id='getattr', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load()), Name(id='attr', ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='files', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Attribute(value=Name(id='CompatibilityFiles', ctx=Load()), attr='SpecPath', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='spec', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='_reader', ctx=Load())], keywords=[]))], decorator_list=[])], decorator_list=[]), FunctionDef(name='wrap_spec', args=arguments(posonlyargs=[], args=[arg(arg='package')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='\n    Construct a package spec with traversable compatibility\n    on the spec/loader/reader.\n    ')), Return(value=Call(func=Name(id='SpecLoaderAdapter', ctx=Load()), args=[Attribute(value=Name(id='package', ctx=Load()), attr='__spec__', ctx=Load()), Name(id='TraversableResourcesLoader', ctx=Load())], keywords=[]))], decorator_list=[])], type_ignores=[])